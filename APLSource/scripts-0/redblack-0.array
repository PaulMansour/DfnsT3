'⍝ Red-black trees:⍞000D⍞000D    put ← ∪ redblack            ⍝ ::       t ← t ∇ k v⍞000D    rem ← ~ redblack            ⍝ ::       t ← t ∇ k⍞000D    get ← ⍎ redblack            ⍝ ::       v ← k ∇ t⍞000D    fmt ← ⍕ redblack            ⍝ ::    -[;] ←   ∇ t⍞000D    vec ← ∊ redblack            ⍝ :: (k v)[] ←   ∇ t⍞000D    chk ← ? redblack            ⍝ ::   ok ht ←   ∇ t⍞000D⍞000D    tree←0∘(put foldl)          ⍝ tree from vector of keys.⍞000D⍞000D    vv ← (''one''1) (''two''2) (''three''3) (''four''4) (''five''5) (''six''6) (''seven''7)⍞000D⍞000D    tt ← tree vv                ⍝ 7-node tree.⍞000D⍞000D    fmt tt                      ⍝ format.⍞000D                           ┌[∘]         ⍞000D                  ┌[five=5]┤            ⍞000D                  │        └[∘]         ⍞000D         ┌<four=4>┤                     ⍞000D         │        │                 ┌[∘]⍞000D         │        │         ┌<one=1>┤   ⍞000D         │        │         │       └[∘]⍞000D         │        └[seven=7]┤           ⍞000D         │                  │       ┌[∘]⍞000D         │                  └<six=6>┤   ⍞000D         │                          └[∘]⍞000D[three=3]┤                              ⍞000D         │       ┌[∘]                   ⍞000D         └[two=2]┤                      ⍞000D                 └[∘]                   ⍞000D⍞000D    chk tt                      ⍝ tree stats.⍞000D1 7 2 4⍞000D⍞000D    ''two'' get tt                ⍝ value for key "two".⍞000D2⍞000D    ''eight'' get tt              ⍝ no value for key "eight".⍞000D6::VALUE ERROR⍞000D⍞000D    disp vec tt                 ⍝ vector of key=value pairs.⍞000D┌────────┬────────┬───────┬─────────┬───────┬─────────┬───────┐⍞000D│┌────┬─┐│┌────┬─┐│┌───┬─┐│┌─────┬─┐│┌───┬─┐│┌─────┬─┐│┌───┬─┐│⍞000D││five│5│││four│4│││one│1│││seven│7│││six│6│││three│3│││two│2││⍞000D│└────┴─┘│└────┴─┘│└───┴─┘│└─────┴─┘│└───┴─┘│└─────┴─┘│└───┴─┘│⍞000D└────────┴────────┴───────┴─────────┴───────┴─────────┴───────┘⍞000D⍞000D    fmt tree ⍳15                ⍝ worst (most unbalanced) case.⍞000D                 ┌[∘]                          ⍞000D           ┌[1=1]┤                             ⍞000D           │     └[∘]                          ⍞000D     ┌[2=2]┤                                   ⍞000D     │     │     ┌[∘]                          ⍞000D     │     └[3=3]┤                             ⍞000D     │           └[∘]                          ⍞000D[4=4]┤                                         ⍞000D     │                 ┌[∘]                    ⍞000D     │           ┌[5=5]┤                       ⍞000D     │           │     └[∘]                    ⍞000D     │     ┌[6=6]┤                             ⍞000D     │     │     │     ┌[∘]                    ⍞000D     │     │     └[7=7]┤                       ⍞000D     │     │           └[∘]                    ⍞000D     └<8=8>┤                                   ⍞000D           │             ┌[∘]                  ⍞000D           │       ┌[9=9]┤                     ⍞000D           │       │     └[∘]                  ⍞000D           └[10=10]┤                           ⍞000D                   │               ┌[∘]        ⍞000D                   │       ┌[11=11]┤           ⍞000D                   │       │       └[∘]        ⍞000D                   └<12=12>┤                   ⍞000D                           │               ┌[∘]⍞000D                           │       ┌<13=13>┤   ⍞000D                           │       │       └[∘]⍞000D                           └[14=14]┤           ⍞000D                                   │       ┌[∘]⍞000D                                   └<15=15>┤   ⍞000D                                           └[∘]⍞000D⍞000D    ⎕rl ← 1                     ⍝ random seed.⍞000D    vv  ← 100?100               ⍝ random vector.⍞000D⍞000D    tt ← tree vv                ⍝ random tree.⍞000D⍞000D    chk tt                      ⍝ tree stats: ok size mean_depth height.⍞000D1 100 5 8⍞000D⍞000D    vv ≡ vv get¨⊂tt             ⍝ retrieve each value.⍞000D1⍞000D    (⍳⍴vv) ≡ vec tt             ⍝ vector of key=value pairs.⍞000D1⍞000D    tt ← tree ⍳7                ⍝ small tree.⍞000D⍞000D    ∧/⊃∘chk¨tt∘rem¨ ⍳7          ⍝ check removal.⍞000D1⍞000D⍞000D    kseq ← 1↓¨,\'' '',12↑⎕a       ⍝ key sequences '''' ''A'' ''AB'' ''ABC'' ...⍞000D⍞000D    disp  kseq⍞000D┌┬─┬──┬───┬────┬─────┬──────┬───────┬────────┬─────────┬──────────┬───────────┬────────────┐⍞000D││A│AB│ABC│ABCD│ABCDE│ABCDEF│ABCDEFG│ABCDEFGH│ABCDEFGHI│ABCDEFGHIJ│ABCDEFGHIJK│ABCDEFGHIJKL│⍞000D└┴─┴──┴───┴────┴─────┴──────┴───────┴────────┴─────────┴──────────┴───────────┴────────────┘⍞000D⍞000D    disp fmt∘tree¨  kseq        ⍝ successive inserts A B C ...⍞000D┌───┬─────────┬───────────────┬───────────────┬─────────────────────┬─────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬─────────────────────────────────┬─────────────────────────────────┬─────────────────────────────────┐⍞000D│[∘]│     ┌[∘]│     ┌[∘]      │           ┌[∘]│           ┌[∘]      │           ┌[∘]      │           ┌[∘]            │           ┌[∘]            │                 ┌[∘]      │                 ┌[∘]      │                 ┌[∘]            │                 ┌[∘]            │                 ┌[∘]            │⍞000D│   │[A=A]┤   │[A=A]┤         │     ┌<A=A>┤   │     ┌[A=A]┤         │     ┌[A=A]┤         │     ┌[A=A]┤               │     ┌[A=A]┤               │           ┌[A=A]┤         │           ┌[A=A]┤         │           ┌[A=A]┤               │           ┌[A=A]┤               │           ┌[A=A]┤               │⍞000D│   │     └[∘]│     │     ┌[∘]│     │     └[∘]│     │     └[∘]      │     │     └[∘]      │     │     └[∘]            │     │     └[∘]            │           │     └[∘]      │           │     └[∘]      │           │     └[∘]            │           │     └[∘]            │           │     └[∘]            │⍞000D│   │         │     └<B=B>┤   │[B=B]┤         │[B=B]┤               │[B=B]┤               │[B=B]┤                     │[B=B]┤                     │     ┌<B=B>┤               │     ┌<B=B>┤               │     ┌[B=B]┤                     │     ┌[B=B]┤                     │     ┌[B=B]┤                     │⍞000D│   │         │           └[∘]│     │     ┌[∘]│     │     ┌[∘]      │     │           ┌[∘]│     │           ┌[∘]      │     │           ┌[∘]      │     │     │     ┌[∘]      │     │     │     ┌[∘]      │     │     │     ┌[∘]            │     │     │     ┌[∘]            │     │     │     ┌[∘]            │⍞000D│   │         │               │     └<C=C>┤   │     └[C=C]┤         │     │     ┌<C=C>┤   │     │     ┌[C=C]┤         │     │     ┌[C=C]┤         │     │     └[C=C]┤         │     │     └[C=C]┤         │     │     └[C=C]┤               │     │     └[C=C]┤               │     │     └[C=C]┤               │⍞000D│   │         │               │           └[∘]│           │     ┌[∘]│     │     │     └[∘]│     │     │     └[∘]      │     │     │     └[∘]      │     │           └[∘]      │     │           └[∘]      │     │           └[∘]            │     │           └[∘]            │     │           └[∘]            │⍞000D│   │         │               │               │           └<D=D>┤   │     └[D=D]┤         │     └<D=D>┤               │     └<D=D>┤               │[D=D]┤                     │[D=D]┤                     │[D=D]┤                           │[D=D]┤                           │[D=D]┤                           │⍞000D│   │         │               │               │                 └[∘]│           │     ┌[∘]│           │     ┌[∘]      │           │           ┌[∘]│     │           ┌[∘]      │     │           ┌[∘]      │     │           ┌[∘]            │     │           ┌[∘]            │     │                 ┌[∘]      │⍞000D│   │         │               │               │                     │           └<E=E>┤   │           └[E=E]┤         │           │     ┌<E=E>┤   │     │     ┌[E=E]┤         │     │     ┌[E=E]┤         │     │     ┌[E=E]┤               │     │     ┌[E=E]┤               │     │           ┌[E=E]┤         │⍞000D│   │         │               │               │                     │                 └[∘]│                 │     ┌[∘]│           │     │     └[∘]│     │     │     └[∘]      │     │     │     └[∘]      │     │     │     └[∘]            │     │     │     └[∘]            │     │           │     └[∘]      │⍞000D│   │         │               │               │                     │                     │                 └<F=F>┤   │           └[F=F]┤         │     └<F=F>┤               │     └<F=F>┤               │     └[F=F]┤                     │     └[F=F]┤                     │     │     ┌<F=F>┤               │⍞000D│   │         │               │               │                     │                     │                       └[∘]│                 │     ┌[∘]│           │     ┌[∘]      │           │           ┌[∘]│           │           ┌[∘]      │           │           ┌[∘]      │     │     │     │     ┌[∘]      │⍞000D│   │         │               │               │                     │                     │                           │                 └<G=G>┤   │           └[G=G]┤         │           │     ┌<G=G>┤   │           │     ┌[G=G]┤         │           │     ┌[G=G]┤         │     │     │     └[G=G]┤         │⍞000D│   │         │               │               │                     │                     │                           │                       └[∘]│                 │     ┌[∘]│           │     │     └[∘]│           │     │     └[∘]      │           │     │     └[∘]      │     │     │           └[∘]      │⍞000D│   │         │               │               │                     │                     │                           │                           │                 └<H=H>┤   │           └[H=H]┤         │           └<H=H>┤               │           └<H=H>┤               │     └[H=H]┤                     │⍞000D│   │         │               │               │                     │                     │                           │                           │                       └[∘]│                 │     ┌[∘]│                 │     ┌[∘]      │                 │           ┌[∘]│           │           ┌[∘]      │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                 └<I=I>┤   │                 └[I=I]┤         │                 │     ┌<I=I>┤   │           │     ┌[I=I]┤         │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                       └[∘]│                       │     ┌[∘]│                 │     │     └[∘]│           │     │     └[∘]      │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                       └<J=J>┤   │                 └[J=J]┤         │           └<J=J>┤               │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                             └[∘]│                       │     ┌[∘]│                 │     ┌[∘]      │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                                 │                       └<K=K>┤   │                 └[K=K]┤         │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                                 │                             └[∘]│                       │     ┌[∘]│⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                                 │                                 │                       └<L=L>┤   │⍞000D│   │         │               │               │                     │                     │                           │                           │                           │                           │                                 │                                 │                             └[∘]│⍞000D└───┴─────────┴───────────────┴───────────────┴─────────────────────┴─────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴─────────────────────────────────┴─────────────────────────────────┴─────────────────────────────────┘⍞000D⍞000D    disp fmt¨ (tree 12↑⎕a)∘(rem foldl)¨ kseq    ⍝ successive removals A B C ...⍞000D┌─────────────────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬───────────────────────────┬─────────────────────┬─────────────────────┬───────────────┬───────────────┬─────────┬───┐⍞000D│                 ┌[∘]            │                 ┌[∘]      │                 ┌[∘]      │                 ┌[∘]      │                 ┌[∘]      │           ┌[∘]            │           ┌[∘]            │           ┌[∘]      │           ┌[∘]      │           ┌[∘]│     ┌[∘]      │     ┌[∘]│[∘]│⍞000D│           ┌[A=A]┤               │           ┌[B=B]┤         │           ┌[C=C]┤         │           ┌[D=D]┤         │           ┌[E=E]┤         │     ┌[F=F]┤               │     ┌[G=G]┤               │     ┌[H=H]┤         │     ┌[I=I]┤         │     ┌[J=J]┤   │[K=K]┤         │[L=L]┤   │   │⍞000D│           │     └[∘]            │           │     │     ┌[∘]│           │     └[∘]      │           │     │     ┌[∘]│           │     └[∘]      │     │     │     ┌[∘]      │     │     └[∘]            │     │     │     ┌[∘]│     │     └[∘]      │     │     └[∘]│     │     ┌[∘]│     └[∘]│   │⍞000D│     ┌[B=B]┤                     │           │     └<C=C>┤   │     ┌[D=D]┤               │           │     └<E=E>┤   │     ┌[F=F]┤               │     │     └<G=G>┤         │[H=H]┤                     │     │     └<I=I>┤   │[J=J]┤               │[K=K]┤         │     └<L=L>┤   │         │   │⍞000D│     │     │     ┌[∘]            │           │           └[∘]│     │     │           ┌[∘]│           │           └[∘]│     │     │     ┌[∘]      │     │           └[∘]      │     │           ┌[∘]      │     │           └[∘]│     │     ┌[∘]      │     │     ┌[∘]│           └[∘]│         │   │⍞000D│     │     └[C=C]┤               │     ┌[D=D]┤               │     │     │     ┌[E=E]┤   │     ┌[F=F]┤               │     │     └[G=G]┤         │[H=H]┤                     │     │     ┌[I=I]┤         │[J=J]┤               │     └[K=K]┤         │     └[L=L]┤   │               │         │   │⍞000D│     │           └[∘]            │     │     │           ┌[∘]│     │     │     │     └[∘]│     │     │     ┌[∘]      │     │           └[∘]      │     │           ┌[∘]      │     │     │     └[∘]      │     │     ┌[∘]      │           │     ┌[∘]│           └[∘]│               │         │   │⍞000D│[D=D]┤                           │     │     │     ┌[E=E]┤   │     │     └<F=F>┤         │     │     └[G=G]┤         │[H=H]┤                     │     │     ┌[I=I]┤         │     └<J=J>┤               │     └[K=K]┤         │           └<L=L>┤   │               │               │         │   │⍞000D│     │                 ┌[∘]      │     │     │     │     └[∘]│     │           │     ┌[∘]│     │           └[∘]      │     │           ┌[∘]      │     │     │     └[∘]      │           │     ┌[∘]      │           │     ┌[∘]│                 └[∘]│               │               │         │   │⍞000D│     │           ┌[E=E]┤         │     │     └<F=F>┤         │     │           └[G=G]┤   │[H=H]┤                     │     │     ┌[I=I]┤         │     └<J=J>┤               │           └[K=K]┤         │           └<L=L>┤   │                     │               │               │         │   │⍞000D│     │           │     └[∘]      │     │           │     ┌[∘]│     │                 └[∘]│     │           ┌[∘]      │     │     │     └[∘]      │           │     ┌[∘]      │                 │     ┌[∘]│                 └[∘]│                     │               │               │         │   │⍞000D│     │     ┌<F=F>┤               │     │           └[G=G]┤   │[H=H]┤                     │     │     ┌[I=I]┤         │     └[J=J]┤               │           └[K=K]┤         │                 └<L=L>┤   │                     │                     │               │               │         │   │⍞000D│     │     │     │     ┌[∘]      │     │                 └[∘]│     │           ┌[∘]      │     │     │     └[∘]      │           │     ┌[∘]      │                 │     ┌[∘]│                       └[∘]│                     │                     │               │               │         │   │⍞000D│     │     │     └[G=G]┤         │[H=H]┤                     │     │     ┌[I=I]┤         │     └[J=J]┤               │           └[K=K]┤         │                 └<L=L>┤   │                           │                     │                     │               │               │         │   │⍞000D│     │     │           └[∘]      │     │           ┌[∘]      │     │     │     └[∘]      │           │     ┌[∘]      │                 │     ┌[∘]│                       └[∘]│                           │                     │                     │               │               │         │   │⍞000D│     └[H=H]┤                     │     │     ┌[I=I]┤         │     └[J=J]┤               │           └[K=K]┤         │                 └<L=L>┤   │                           │                           │                     │                     │               │               │         │   │⍞000D│           │           ┌[∘]      │     │     │     └[∘]      │           │     ┌[∘]      │                 │     ┌[∘]│                       └[∘]│                           │                           │                     │                     │               │               │         │   │⍞000D│           │     ┌[I=I]┤         │     └[J=J]┤               │           └[K=K]┤         │                 └<L=L>┤   │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│           │     │     └[∘]      │           │     ┌[∘]      │                 │     ┌[∘]│                       └[∘]│                           │                           │                           │                     │                     │               │               │         │   │⍞000D│           └<J=J>┤               │           └[K=K]┤         │                 └<L=L>┤   │                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│                 │     ┌[∘]      │                 │     ┌[∘]│                       └[∘]│                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│                 └[K=K]┤         │                 └<L=L>┤   │                           │                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│                       │     ┌[∘]│                       └[∘]│                           │                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│                       └<L=L>┤   │                           │                           │                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D│                             └[∘]│                           │                           │                           │                           │                           │                           │                     │                     │               │               │         │   │⍞000D└─────────────────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴───────────────────────────┴─────────────────────┴─────────────────────┴───────────────┴───────────────┴─────────┴───┘⍞000D⍞000D    Alpha test ''_BST''           ⍝ common BST tests.⍞000D1' 
