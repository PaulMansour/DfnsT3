'⍝ Permutation matrix of ⍳⍵:⍞000D⍞000D      ⎕io←1⍞000D⍞000D      pmat 3                            ⍝ 3-perms.⍞000D1 2 3⍞000D1 3 2⍞000D2 1 3⍞000D2 3 1⍞000D3 1 2⍞000D3 2 1⍞000D⍞000D      {⍵[pmat⍴⍵]}''tic'' ''tac'' ''toe''      ⍝ Perms of nested vector.⍞000D tic  tac  toe ⍞000D tic  toe  tac ⍞000D tac  tic  toe ⍞000D tac  toe  tic ⍞000D toe  tic  tac ⍞000D toe  tac  tic ⍞000D⍞000D      4 3 2⍴↓{⍵[pmat⍴⍵]}''abcd''          ⍝ Folded perms of simple 4-vector.⍞000D abcd  abdc ⍞000D acbd  acdb ⍞000D adbc  adcb ⍞000D            ⍞000D bacd  badc ⍞000D bcad  bcda ⍞000D bdac  bdca ⍞000D            ⍞000D cabd  cadb ⍞000D cbad  cbda ⍞000D cdab  cdba ⍞000D            ⍞000D dabc  dacb ⍞000D dbac  dbca ⍞000D dcab  dcba ⍞000D⍞000D      display∘pmat¨2 1 0                ⍝ Limiting cases⍞000D ┌→──┐  ┌→┐  ┌⊖┐ ⍞000D ↓1 2│  ↓1│  ↓0│ ⍞000D │2 1│  └~┘  └~┘ ⍞000D └~──┘           ⍞000D⍞000D      (!0 to 5) ≡ ⎕io∘⊃∘⍴∘pmat¨0 to 5   ⍝ Result lengths.⍞000D1⍞000D                                        ⍝ Rows of the permutation matrix form⍞000D      {⍵⍳⍵∘.{⍺⊃¨⊂⍵}⍵}↓pmat 3            ⍝ a group under ⊃¨∘⊂ with identity ⍳⍵.⍞000D1 2 3 4 5 6⍞000D2 1 4 3 6 5⍞000D3 5 1 6 2 4⍞000D4 6 2 5 1 3⍞000D5 3 6 1 4 2⍞000D6 4 5 2 3 1⍞000D⍞000D    perms←{                 ⍝ Apply ⍺⍺ to each perm of ⍳⍵⍞000D        ⍬ ⍺⍺{               ⍝ null accumulator⍞000D            1≥⍴⍵:⍺⍺ ⍺,⍵     ⍝ short tail: apply operand to perm⍞000D            (⍺∘,¨⍵)∇¨⍵∘~¨⍵  ⍝ transfer each tail item to head⍞000D        }⍳⍵                 ⍝ for initial vector.⍞000D    }⍞000D⍞000D    disp +perms 3⍞000D┌─────────────┬─────────────┬─────────────┐⍞000D│┌─────┬─────┐│┌─────┬─────┐│┌─────┬─────┐│⍞000D││1 2 3│1 3 2│││2 1 3│2 3 1│││3 1 2│3 2 1││⍞000D│└─────┴─────┘│└─────┴─────┘│└─────┴─────┘│⍞000D└─────────────┴─────────────┴─────────────┘' 
