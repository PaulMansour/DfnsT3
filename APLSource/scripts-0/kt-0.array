'⍝ Knight''s Tour Chess Problem:⍞000D⍞000D      ⎕io←1⍞000D⍞000D      kt 8 8                    ⍝ 1 tour around a standard 8×8 board.⍞000D  1 26 15 24 29 50 13 32 ⍞000D 16 23 28 51 14 31 64 49 ⍞000D 27  2 25 30 63 60 33 12 ⍞000D 22 17 52 59 44 57 48 61 ⍞000D  3 42 21 56 53 62 11 34 ⍞000D 18 39 54 43 58 45  8 47 ⍞000D 41  4 37 20 55  6 35 10 ⍞000D 38 19 40  5 36  9 46  7 ⍞000D⍞000D      disp 3 kt 5 5             ⍝ 3 tours around a smaller board.⍞000D┌──────────────┬──────────────┬──────────────┐⍞000D│ 1 12 25 18  7│ 1 12 23 18  7│ 1 12 23 18  7│⍞000D│22 17  8 13 24│22 17  8 13 24│24 17  8 13 22│⍞000D│11  2 23  6 19│11  2 25  6 19│11  2 21  6 19│⍞000D│16 21  4  9 14│16 21  4  9 14│16 25  4  9 14│⍞000D│ 3 10 15 20  5│ 3 10 15 20  5│ 3 10 15 20  5│⍞000D└──────────────┴──────────────┴──────────────┘⍞000D⍞000D      kt 3 4                    ⍝ Tour around a non-square board.⍞000D  1 4  7 10 ⍞000D 12 9  2  5 ⍞000D  3 6 11  8 ⍞000D⍞000D      disp ¯1 kt 4 3            ⍝ All solutions for a 4×3 board.⍞000D┌────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐⍞000D│ 1 12  3│ 1  8  3│12  1 10│ 8  1 10│10  1 12│10  1  8│ 3 12  1│ 3  8  1│10  5 12│10  5  8│ 3 12  5│ 3  8  5│ 5 12  3│ 5  8  3│12  5 10│ 8  5 10│⍞000D│ 4  9  6│ 4 11  6│ 9  4  7│11  4  7│ 7  4  9│ 7  4 11│ 6  9  4│ 6 11  4│ 7  2  9│ 7  2 11│ 6  9  2│ 6 11  2│ 2  9  6│ 2 11  6│ 9  2  7│11  2  7│⍞000D│ 7  2 11│ 7  2  9│ 6 11  2│ 6  9  2│ 2 11  6│ 2  9  6│11  2  7│ 9  2  7│ 4 11  6│ 4  9  6│11  4  7│ 9  4  7│ 7  4 11│ 7  4  9│ 6 11  4│ 6  9  4│⍞000D│10  5  8│10  5 12│ 3  8  5│ 3 12  5│ 5  8  3│ 5 12  3│ 8  5 10│12  5 10│ 1  8  3│ 1 12  3│ 8  1 10│12  1 10│10  1  8│10  1 12│ 3  8  1│ 3 12  1│⍞000D└────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘⍞000D⍞000D    gkt←{⎕ML←0                          ⍝ General Knight''s Tour Chess Problem.⍞000D        ⍺←1 ⋄ sreq←⍺                    ⍝ no. of solutions required, default: 1.⍞000D        bsize kdefn←{                   ⍝ board size and moves definition.⍞000D            1+(-⍴⍺)↑⍵-1                 ⍝ extend to left with 1''s.⍞000D        }\2↑(↓⍵),⊂1 2                   ⍝ default (1 2)-knight.⍞000D        nsqs←×/bsize ⋄ grid←,¨⍳bsize    ⍝ number of squares and grid coords.⍞000D        net←(⊂,grid)∩¨↓grid∘.+∪,↓↑{     ⍝ absolute moves from each square.⍞000D            ⍵[pmat⍴⍵]                   ⍝ all permutations of moves,⍞000D        }∘,¨↑∘.,/1 ¯1∘×¨kdefn           ⍝ in each possible direction.⍞000D        ⍳∘grid¨↑⍬{                      ⍝ initially empty placement vector.⍞000D            sreq=⍴⍵:⍵                   ⍝ found required no. of solutions: stop.⍞000D            path←⍺⍺,⊂⍺                  ⍝ extended placement vector.⍞000D            nsqs=⍴path:⍵,⊂path          ⍝ solution: accumulate.⍞000D            nxt←(⊂⍺)⊃⍵⍵                 ⍝ moves from current square.⍞000D            0=⍴nxt:⍵                    ⍝ stitched: back out.⍞000D            net←⍵⍵~¨⊂⊂⍺                 ⍝ compressed net.⍞000D            ord←nxt[⍒↑⍴¨net[nxt]]       ⍝ tightest-rightmost order.⍞000D            ↑path ∇∇ net/ord,⊂⍵         ⍝ pursue remaining possibilities.⍞000D        }net/(⌽,grid),⊂0⍴⊂⍬             ⍝ from each starting position.⍞000D    }⍞000D⍞000D      gkt 8 8                   ⍝ Tour of standard board by normal (1 2)-knight.⍞000D  1 26 15 24 29 50 13 32 ⍞000D 16 23 28 51 14 31 64 49 ⍞000D 27  2 25 30 63 60 33 12 ⍞000D 22 17 52 59 44 57 48 61 ⍞000D  3 42 21 56 53 62 11 34 ⍞000D 18 39 54 43 58 45  8 47 ⍞000D 41  4 37 20 55  6 35 10 ⍞000D 38 19 40  5 36  9 46  7 ⍞000D⍞000D      gkt 3 3 4 5               ⍝ Tour of a 3×3×4×5 board by a (1 1 1 2)-knight.⍞000D   1 144  43  96  51 ⍞000D  86 155  90 129  22 ⍞000D 123  14 121  76 107 ⍞000D 170  71 180  33 164 ⍞000D                     ⍞000D 136  79 150  25 132 ⍞000D 153  38 147  48  99 ⍞000D  62 173  64 159  28 ⍞000D  11 116  57 102  73 ⍞000D                     ⍞000D   3 142  35  94  45 ⍞000D  82 139  88 127  20 ⍞000D 119   8 113  60 105 ⍞000D 168  69 178  31 162 ⍞000D                     ⍞000D                     ⍞000D 138  81 140  19 126 ⍞000D 151   6 135  46  93 ⍞000D  54 167  74 161  30 ⍞000D   9 114  61 104  59 ⍞000D                     ⍞000D  15 118  83 108  77 ⍞000D  36 179  52 177  34 ⍞000D 175   4 165  42  91 ⍞000D 112  89 124  17 110 ⍞000D                     ⍞000D 148  85 154  23 130 ⍞000D 145  40 133  50  97 ⍞000D  56 171  72 157  26 ⍞000D  13 122  67 100  65 ⍞000D                     ⍞000D                     ⍞000D  39 146  41  98  49 ⍞000D  84 149  78 131  24 ⍞000D 117  12 111  66 101 ⍞000D 172  63 176  27 158 ⍞000D                     ⍞000D 134  87 156  21 128 ⍞000D 141   2 143  44  95 ⍞000D  68 169  70 163  32 ⍞000D   7 120  55 106  75 ⍞000D                     ⍞000D   5 152  37  92  47 ⍞000D  80 137  16 125  18 ⍞000D 115  10 109  58 103 ⍞000D 166  53 174  29 160 ⍞000D⍞000D      disp ¯1 gkt ⍪3 1          ⍝ All tours of a 3 board by a 1-knight.⍞000D┌─────┬─────┐⍞000D│1 2 3│3 2 1│⍞000D└─────┴─────┘⍞000D⍞000D    kt_aw←{⎕io←0                ⍝ Arthur''s coding.⍞000D        n←⍵⍞000D        m←,0 1∘.⌽1 ¯1∘.,2 ¯2⍞000D        m←{n⊥¨(⍵≡¨n|⍵)/⍵}¨↓(,⍳n n)∘.+m⍞000D        k←{0<⍴⍵:⍵⋄(⍴m)=⍴x←⍺⍺,⍺:x⋄⊃x∇∇/z[⍒↑⍴¨m[z←(⍺⊃m)~x]~¨⊂x],⊂⍵}⍞000D        n n⍴⍋0(⍬k)⍬⍞000D    }⍞000D⍞000D    kt_aw 8⍞000D 0 57 14 31 48 27 12 29⍞000D15 32 53 62 13 30 49 26⍞000D58  1 56 45 54 47 28 11⍞000D33 16 61 52 63 44 25 50⍞000D 2 59 42 55 46 51 10 39⍞000D17 34 19 60 43 40  7 24⍞000D20  3 36 41 22  5 38  9⍞000D35 18 21  4 37  8 23  6⍞000D⍞000D⍝ Roger''s coding:⍞000D⍞000D      ktourw←{⎕io ⎕ml←0  ⍝ Warnsdorff''s algorithm for the (⍵,⍵) knight''s tour⍞000D          f←{⍵,c[{⍵⍳⌊/⍵}+/~⍺[c←⍺[⊃⌽⍵;]~⍵;]∊⍵]}⍞000D          M←↑(↓∧/(↑t)∊⍳⍵)/¨↓⍵⊥¨t←(,⍳⍵,⍵)∘.+,0 1∘.⌽2 ¯2∘.,1 ¯1⍞000D          (⍵,⍵)⍴⍋M f⍣(¯1+⍵×⍵),0⍞000D      }⍞000D⍞000D      ktourw 8⍞000D 0 49 14 31 60 27 12 29⍞000D15 32 63 54 13 30 59 26⍞000D50  1 48 43 56 61 28 11⍞000D33 16 55 62 53 46 25 58⍞000D 2 51 44 47 42 57 10 39⍞000D17 34 19 52 45 40  7 24⍞000D20  3 36 41 22  5 38  9⍞000D35 18 21  4 37  8 23  6' 
