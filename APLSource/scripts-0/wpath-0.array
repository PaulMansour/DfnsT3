'    Alpha test''wGraphs''⍞000D1⍞000D    ⍝ Mike''s cases:⍞000D⍞000D    ⍝   A───2──→B⍞000D    ⍝   │       │⍞000D    ⍝   3       1⍞000D    ⍝   ↓       ↓⍞000D    ⍝   C───2──→D⍞000D⍞000D    md1←,¨↑ ((2 3)4 4 ⍬) ((2 3)1 2 ⍬)⍞000D          ⍝   A   B C D /  A   B C D⍞000D⍞000D    1 disp md1⍞000D┌→──┬─┬─┬─┐⍞000D↓2 3│4│4│0│⍞000D├~─→┼→┼→┼⊖┤⍞000D│2 3│1│2│0│⍞000D└~─→┴→┴→┴⊖┘⍞000D⍞000D    md1 wpath 1 4       ⍝ path from A to D.⍞000D1 2 4⍞000D⍞000D    ⍝   ┌───2───B───2───┐⍞000D    ⍝   │               │⍞000D    ⍝   ↑               ↓⍞000D    ⍝   │               │⍞000D    ⍝   A───2──→C───1──→E⍞000D    ⍝   │               │⍞000D    ⍝   ↓               ↑⍞000D    ⍝   │               │⍞000D    ⍝   └───2───D───2───┘⍞000D⍞000D    md2←,¨↑((2 3 4) 5 5 5 ⍬) ((2 2 2)2 1 2 ⍬)⍞000D          ⍝  A      B C D E /  A     B C D E⍞000D⍞000D    md2 wpath 1 5       ⍝ path from A to E.⍞000D1 3 5⍞000D⍞000D    mattographa←{⎕ML←0⍞000D        i←{⍵⍴⍳×/⍵}⍴⍵⍞000D        max←1+⌈/,i⍞000D        ⍺←1 1 1 1           ⍝ if up left right down⍞000D        addlink←{⍞000D            1 1↓¯1 ¯1↓⍺{⍞000D                ⍺=0:⍵⍞000D                ⍺=1:¯1⊖⍵⍞000D                ⍺=2:¯1⌽⍵⍞000D                ⍺=3:1⌽⍵⍞000D                ⍺=4:1⊖⍵⍞000D            }⍵⍞000D        }⍞000D        op←⍺/⍳4⍞000D        w←max,max,⍨max⍪max⍪⍨i⍞000D        links←,{⍵/⍨⍵<max}¨↓[⎕IO]↑op addlink¨⊂w⍞000D        costs←links{⍺⊃¨⊂⍵}¨⊂,⍵⍞000D        links←(⊂⊂¨,i)⍳¨⊂¨¨links⍞000D        ↑links costs⍞000D    }⍞000D⍞000D    small←0 5⍴0⍞000D⍞000D    small ⍪← 131 673 234 103  18⍞000D    small ⍪← 201  96 342 965 150⍞000D    small ⍪← 630 803 746 422 111⍞000D    small ⍪← 537 699 497 121 956⍞000D    small ⍪← 805 732 524  37 331⍞000D⍞000D    1 25 wpath⍨ 0 0 1 1 mattographa small⍞000D1 6 7 8 13 14 19 24 25⍞000D⍞000D    m2g←{⎕ML←0                          ⍝ Graph from weightings matrix.⍞000D        ⍺←1 1 1 1                       ⍝ up left right down.⍞000D        dirns←⍺/(¯1 0)(0 ¯1)(0 1)(1 0)  ⍝ directions.⍞000D        xvecs←dirns∘+∘⊂¨⍳⍴⍵             ⍝ index vectors per link.⍞000D        links←,{⍵⍳¨⍵∩¨xvecs}⊂,⍳⍴⍵       ⍝ unweighted graph.⍞000D        costs←,links{⍺⊃¨⊂⍵}¨⊂,⍵         ⍝ costs per link.⍞000D        ↑links costs                    ⍝ weighted graph.⍞000D    }⍞000D⍞000D    1 25 wpath⍨ 0 0 1 1 m2g small⍞000D1 6 7 8 13 14 19 24 25' 
