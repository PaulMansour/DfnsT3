'⍝ Binary Search Trees:⍞000D⍞000D    put ← ∪ sbst    ⍝ insert/update             :: tree ← tree ∇ key val⍞000D    get ← ⍎ sbst    ⍝ retrieve val for key      :: val tree ← key ∇ tree⍞000D    rem ← ~ sbst    ⍝ remove key from tree      :: tree ← tree ∇ key⍞000D    fmt ← ⍕ sbst    ⍝ formatted tree            :: char[;] ← ∇ tree⍞000D    chk ← ? sbst    ⍝ tree statistics           :: ok height size ← ∇ tree⍞000D    vec ← ∊ sbst    ⍝ enlist of tree            :: (key val)[] ← ∇ tree⍞000D    bal ← = sbst    ⍝ balance of tree ⍵         :: tree ← ∇ tree⍞000D⍞000D    tree←0∘(put foldl)          ⍝ tree from vector of keys.⍞000D⍞000D    fmt tree ⍳15                ⍝ unbalanced tree.⍞000D1=1┐                                                                   ⍞000D   └2=2┐                                                               ⍞000D       └3=3┐                                                           ⍞000D           └4=4┐                                                       ⍞000D               └5=5┐                                                   ⍞000D                   └6=6┐                                               ⍞000D                       └7=7┐                                           ⍞000D                           └8=8┐                                       ⍞000D                               └9=9┐                                   ⍞000D                                   └10=10┐                             ⍞000D                                         └11=11┐                       ⍞000D                                               └12=12┐                 ⍞000D                                                     └13=13┐           ⍞000D                                                           └14=14┐     ⍞000D                                                                 └15=15⍞000D    ⎕rl←7*5                     ⍝ set random seed.⍞000D⍞000D    fmt tree 15?15              ⍝ random tree.⍞000D   ┌1=1                          ⍞000D2=2┤                             ⍞000D   │                     ┌3=3┐   ⍞000D   │                     │   └4=4⍞000D   │                 ┌5=5┘       ⍞000D   │             ┌6=6┘           ⍞000D   │         ┌7=7┘               ⍞000D   │     ┌8=8┤                   ⍞000D   │     │   │     ┌9=9          ⍞000D   │     │   └10=10┤             ⍞000D   │     │         └11=11        ⍞000D   └12=12┤                       ⍞000D         └13=13┐                 ⍞000D               │     ┌14=14      ⍞000D               └15=15┘           ⍞000D⍞000D    fmt bal tree 15?15          ⍝ balanced random tree.⍞000D           ┌1=1      ⍞000D       ┌2=2┤         ⍞000D       │   └3=3      ⍞000D   ┌4=4┤             ⍞000D   │   │   ┌5=5      ⍞000D   │   └6=6┤         ⍞000D   │       └7=7      ⍞000D8=8┤                 ⍞000D   │           ┌9=9  ⍞000D   │     ┌10=10┤     ⍞000D   │     │     └11=11⍞000D   └12=12┤           ⍞000D         │     ┌13=13⍞000D         └14=14┤     ⍞000D               └15=15⍞000D⍞000D⍞000D    pangram←''jackdaws love my big sphinx of quartz''~'' ''⍞000D⍞000D    fmt tree pangram⍞000D   ┌a=a┐                           ⍞000D   │   │   ┌b=b                    ⍞000D   │   └c=c┤                       ⍞000D   │       └d=d┐                   ⍞000D   │           └e=e┐               ⍞000D   │               │       ┌f=f    ⍞000D   │               │   ┌g=g┤       ⍞000D   │               │   │   └h=h    ⍞000D   │               └i=i┘           ⍞000Dj=j┤                               ⍞000D   └k=k┐                           ⍞000D       │       ┌l=l┐               ⍞000D       │       │   │   ┌m=m┐       ⍞000D       │       │   │   │   └n=n    ⍞000D       │       │   └o=o┤           ⍞000D       │       │       └p=p┐       ⍞000D       │       │           └q=q┐   ⍞000D       │       │               └r=r⍞000D       │   ┌s=s┤                   ⍞000D       │   │   │       ┌t=t        ⍞000D       │   │   │   ┌u=u┘           ⍞000D       │   │   └v=v┘               ⍞000D       └w=w┤                       ⍞000D           │   ┌x=x                ⍞000D           └y=y┤                   ⍞000D               └z=z                ⍞000D⍞000D    fmt bal tree pangram                ⍝ balanced tree.⍞000D           ┌a=a    ⍞000D       ┌b=b┤       ⍞000D       │   └c=c    ⍞000D   ┌d=d┤           ⍞000D   │   │   ┌e=e┐   ⍞000D   │   │   │   └f=f⍞000D   │   └g=g┤       ⍞000D   │       │   ┌h=h⍞000D   │       └i=i┤   ⍞000D   │           └j=j⍞000Dk=k┤               ⍞000D   │           ┌l=l⍞000D   │       ┌m=m┤   ⍞000D   │       │   └n=n⍞000D   │   ┌o=o┤       ⍞000D   │   │   │   ┌p=p⍞000D   │   │   └q=q┤   ⍞000D   │   │       └r=r⍞000D   └s=s┤           ⍞000D       │       ┌t=t⍞000D       │   ┌u=u┤   ⍞000D       │   │   └v=v⍞000D       └w=w┤       ⍞000D           │   ┌x=x⍞000D           └y=y┤   ⍞000D               └z=z⍞000D⍞000D    disp {fmt bal 0 put foldl ⍵}¨ 1↓¨,\'' '',⎕a           ⍝ test balancing.⍞000D┌┬───┬───────┬───────┬───────────┬───────────┬───────────┬───────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┬───────────────────┐⍞000D││A=A│A=A┐   │   ┌A=A│   ┌A=A    │   ┌A=A    │   ┌A=A┐   │       ┌A=A│       ┌A=A    │       ┌A=A    │       ┌A=A    │       ┌A=A    │       ┌A=A    │       ┌A=A    │       ┌A=A┐   │           ┌A=A│           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │           ┌A=A    │⍞000D││   │   └B=B│B=B┤   │B=B┤       │B=B┤       │   │   └B=B│   ┌B=B┤   │   ┌B=B┤       │   ┌B=B┤       │   ┌B=B┤       │   ┌B=B┤       │   ┌B=B┤       │   ┌B=B┤       │       │   └B=B│       ┌B=B┤   │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │       ┌B=B┤       │⍞000D││   │       │   └C=C│   └C=C┐   │   │   ┌C=C│C=C┤       │   │   └C=C│   │   └C=C    │   │   └C=C    │   │   └C=C    │   │   └C=C    │   │   └C=C┐   │   │   │   ┌C=C│   ┌C=C┤       │       │   └C=C│       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │       │   └C=C    │⍞000D││   │       │       │       └D=D│   └D=D┤   │   │   ┌D=D│D=D┤       │D=D┤           │D=D┤           │D=D┤           │D=D┤           │   │       └D=D│   │   └D=D┤   │   │   │   ┌D=D│   ┌D=D┤       │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │   ┌D=D┤           │⍞000D││   │       │       │           │       └E=E│   └E=E┤   │   │   ┌E=E│   │   ┌E=E    │   │   ┌E=E    │   │   ┌E=E┐   │   │       ┌E=E│E=E┤           │   │       └E=E│   │   └E=E┤   │   │   │   ┌E=E│   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E    │   │   │   ┌E=E┐   │⍞000D││   │       │       │           │           │       └F=F│   └F=F┤   │   └F=F┤       │   └F=F┤       │   │   │   └F=F│   │   ┌F=F┤   │   │       ┌F=F│F=F┤           │   │       └F=F│   │   └F=F┤   │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   └F=F┤       │   │   │   │   └F=F│⍞000D││   │       │       │           │           │           │       └G=G│       └G=G┐   │       │   ┌G=G│   └G=G┤       │   │   │   └G=G│   │   ┌G=G┤   │   │       ┌G=G│G=G┤           │   │       └G=G│   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G    │   │       └G=G┐   │   │       │   ┌G=G│   │   └G=G┤       │⍞000D││   │       │       │           │           │           │           │           └H=H│       └H=H┤   │       │   ┌H=H│   └H=H┤       │   │   │   └H=H│   │   ┌H=H┤   │   │       ┌H=H│H=H┤           │H=H┤               │H=H┤               │H=H┤               │H=H┤               │H=H┤               │H=H┤               │H=H┤               │H=H┤               │   │           └H=H│   │       └H=H┤   │   │       │   ┌H=H│⍞000D││   │       │       │           │           │           │           │               │           └I=I│       └I=I┤   │       │   ┌I=I│   └I=I┤       │   │   │   └I=I│   │   ┌I=I┤   │   │       ┌I=I│   │       ┌I=I    │   │       ┌I=I    │   │       ┌I=I    │   │       ┌I=I    │   │       ┌I=I    │   │       ┌I=I    │   │       ┌I=I┐   │   │           ┌I=I│I=I┤               │   │           └I=I│   │       └I=I┤   │⍞000D││   │       │       │           │           │           │           │               │               │           └J=J│       └J=J┤   │       │   ┌J=J│   └J=J┤       │   │   │   └J=J│   │   ┌J=J┤   │   │   ┌J=J┤       │   │   ┌J=J┤       │   │   ┌J=J┤       │   │   ┌J=J┤       │   │   ┌J=J┤       │   │   ┌J=J┤       │   │       │   └J=J│   │       ┌J=J┤   │   │           ┌J=J│J=J┤               │   │           └J=J│⍞000D││   │       │       │           │           │           │           │               │               │               │           └K=K│       └K=K┤   │       │   ┌K=K│   └K=K┤       │   │   │   └K=K│   │   │   └K=K    │   │   │   └K=K    │   │   │   └K=K    │   │   │   └K=K    │   │   │   └K=K┐   │   │   │   │   ┌K=K│   │   ┌K=K┤       │   │       │   └K=K│   │       ┌K=K┤   │   │           ┌K=K│K=K┤               │⍞000D││   │       │       │           │           │           │           │               │               │               │               │           └L=L│       └L=L┤   │       │   ┌L=L│   └L=L┤       │   └L=L┤           │   └L=L┤           │   └L=L┤           │   └L=L┤           │   │   │       └L=L│   │   │   └L=L┤   │   │   │   │   ┌L=L│   │   ┌L=L┤       │   │       │   └L=L│   │       ┌L=L┤   │   │           ┌L=L│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │           └M=M│       └M=M┤   │       │   ┌M=M│       │   ┌M=M    │       │   ┌M=M    │       │   ┌M=M┐   │       │       ┌M=M│   └M=M┤           │   │   │       └M=M│   │   │   └M=M┤   │   │   │   │   ┌M=M│   │   ┌M=M┤       │   │       │   └M=M│   │       ┌M=M┤   │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │           └N=N│       └N=N┤   │       └N=N┤       │       └N=N┤       │       │   │   └N=N│       │   ┌N=N┤   │       │       ┌N=N│   └N=N┤           │   │   │       └N=N│   │   │   └N=N┤   │   │   │   │   ┌N=N│   │   ┌N=N┤       │   │       │   └N=N│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │           └O=O│           └O=O┐   │           │   ┌O=O│       └O=O┤       │       │   │   └O=O│       │   ┌O=O┤   │       │       ┌O=O│   └O=O┤           │   │   │       └O=O│   │   │   └O=O┤   │   │   │   │   ┌O=O│   │   ┌O=O┤       │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │               └P=P│           └P=P┤   │           │   ┌P=P│       └P=P┤       │       │   │   └P=P│       │   ┌P=P┤   │       │       ┌P=P│   └P=P┤           │   │   │       └P=P│   │   │   └P=P┤   │   │   │   │   ┌P=P│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │               └Q=Q│           └Q=Q┤   │           │   ┌Q=Q│       └Q=Q┤       │       │   │   └Q=Q│       │   ┌Q=Q┤   │       │       ┌Q=Q│   └Q=Q┤           │   │   │       └Q=Q│   │   │   └Q=Q┤   │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │               └R=R│           └R=R┤   │           │   ┌R=R│       └R=R┤       │       │   │   └R=R│       │   ┌R=R┤   │       │       ┌R=R│   └R=R┤           │   │   │       └R=R│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │               └S=S│           └S=S┤   │           │   ┌S=S│       └S=S┤       │       │   │   └S=S│       │   ┌S=S┤   │       │       ┌S=S│   └S=S┤           │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │               └T=T│           └T=T┤   │           │   ┌T=T│       └T=T┤       │       │   │   └T=T│       │   ┌T=T┤   │       │       ┌T=T│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │               └U=U│           └U=U┤   │           │   ┌U=U│       └U=U┤       │       │   │   └U=U│       │   ┌U=U┤   │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │                   │               └V=V│           └V=V┤   │           │   ┌V=V│       └V=V┤       │       │   │   └V=V│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │                   │                   │               └W=W│           └W=W┤   │           │   ┌W=W│       └W=W┤       │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │                   │                   │                   │               └X=X│           └X=X┤   │           │   ┌X=X│⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │                   │                   │                   │                   │               └Y=Y│           └Y=Y┤   │⍞000D││   │       │       │           │           │           │           │               │               │               │               │               │               │               │               │                   │                   │                   │                   │                   │                   │                   │                   │                   │                   │               └Z=Z│⍞000D└┴───┴───────┴───────┴───────────┴───────────┴───────────┴───────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┴───────────────────┘⍞000D⍞000D⍝ Vector of key=value pairs:⍞000D⍞000D    pairs ← (''one''1) (''two''2) (''three''3) (''four''4) (''five''5) (''six''6) (''seven''7)⍞000D⍞000D    tt←0 put foldl pairs            ⍝ pairs folded into tree.⍞000D⍞000D    fmt tt                          ⍝ format of tree.⍞000D            ┌five=5              ⍞000D     ┌four=4┘                    ⍞000Done=1┤                           ⍞000D     │                   ┌seven=7⍞000D     │             ┌six=6┘       ⍞000D     │     ┌three=3┘             ⍞000D     └two=2┘                     ⍞000D⍞000D    tt ← bal tt                     ⍝ balanced tree.⍞000D⍞000D    fmt tt ⍞000D              ┌five=5⍞000D       ┌four=4┤      ⍞000D       │      └one=1 ⍞000Dseven=7┤             ⍞000D       │       ┌six=6⍞000D       └three=3┤     ⍞000D               └two=2⍞000D⍞000D    ''six''get tt                     ⍝ value for key ''six''⍞000D6⍞000D    tt ← tt rem''four''               ⍝ key ''four'' removed.⍞000D⍞000D    fmt tt⍞000D       ┌five=5┐      ⍞000D       │      └one=1 ⍞000Dseven=7┤             ⍞000D       │       ┌six=6⍞000D       └three=3┤     ⍞000D               └two=2⍞000D⍞000D    disp vec tt                     ⍝ vector of key=value pairs.⍞000D┌────────┬───────┬─────────┬───────┬─────────┬───────┐⍞000D│┌────┬─┐│┌───┬─┐│┌─────┬─┐│┌───┬─┐│┌─────┬─┐│┌───┬─┐│⍞000D││five│5│││one│1│││seven│7│││six│6│││three│3│││two│2││⍞000D│└────┴─┘│└───┴─┘│└─────┴─┘│└───┴─┘│└─────┴─┘│└───┴─┘│⍞000D└────────┴───────┴─────────┴───────┴─────────┴───────┘⍞000D⍞000D    chk tt                          ⍝ tree stats: ok size mean_depth height.⍞000D1 6 1 3⍞000D⍞000D    ⎕rl ← 3⊃⎕ts                     ⍝ daily random seed.⍞000D    chk bal tree {⍵?⍵} ¯1+2*10      ⍝ check balance of kilo-node random tree.⍞000D1 1023 8 10⍞000D⍞000D    Alpha test ''_BST''               ⍝ common BST tests.⍞000D1' 
