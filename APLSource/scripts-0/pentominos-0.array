'⍝ Exact cover Pentominos tiling:⍞000D⍞000D    ⍝ Matrix of the 12 pentominos:⍞000D⍞000D    p ←⍉⍪ ''     I                                    ''⍞000D    p ⍪←  ''     I L   N                         Y    ''⍞000D    p ⍪←  ''  FF I L   N PP TTT     V   W    X  YY ZZ ''⍞000D    p ⍪←  '' FF  I L  NN PP  T  U U V   WW  XXX  Y  Z ''⍞000D    p ⍪←  ''  F  I LL N  P   T  UUU VVV  WW  X   Y  ZZ''⍞000D⍞000D    display p                       ⍝ Char matrix with blank separator columns.⍞000D┌→─────────────────────────────────────────┐⍞000D↓     I                                    │⍞000D│     I L   N                         Y    │⍞000D│  FF I L   N PP TTT     V   W    X  YY ZZ │⍞000D│ FF  I L  NN PP  T  U U V   WW  XXX  Y  Z │⍞000D│  F  I LL N  P   T  UUU VVV  WW  X   Y  ZZ│⍞000D└──────────────────────────────────────────┘⍞000D⍞000D    split←{                         ⍝ Individual tiles.⍞000D        segs ← 0 1∘↓¨ (∧⌿⍵='' '')⊂⍵   ⍝ separated at blank columns.⍞000D        {(∨/⍵≠'' '')⌿⍵}¨ segs         ⍝ without blank rows.⍞000D    }⍞000D⍞000D    display split p                 ⍝ Individual tiles.⍞000D┌→──────────────────────────────────────────────────────────────────┐⍞000D│ ┌→──┐ ┌→┐ ┌→─┐ ┌→─┐ ┌→─┐ ┌→──┐ ┌→──┐ ┌→──┐ ┌→──┐ ┌→──┐ ┌→─┐ ┌→──┐ │⍞000D│ ↓ FF│ ↓I│ ↓L │ ↓ N│ ↓PP│ ↓TTT│ ↓U U│ ↓V  │ ↓W  │ ↓ X │ ↓ Y│ ↓ZZ │ │⍞000D│ │FF │ │I│ │L │ │ N│ │PP│ │ T │ │UUU│ │V  │ │WW │ │XXX│ │YY│ │ Z │ │⍞000D│ │ F │ │I│ │L │ │NN│ │P │ │ T │ └───┘ │VVV│ │ WW│ │ X │ │ Y│ │ ZZ│ │⍞000D│ └───┘ │I│ │LL│ │N │ └──┘ └───┘       └───┘ └───┘ └───┘ │ Y│ └───┘ │⍞000D│       │I│ └──┘ └──┘                                    └──┘       │⍞000D│       └─┘                                                         │⍞000D└∊──────────────────────────────────────────────────────────────────┘⍞000D⍞000D    rots ← {⍵(⍉⊖⍵)(⌽⊖⍵)(⊖⍉⍵)}       ⍝ Tile rotations.⍞000D⍞000D    tmat ← ↑ rots¨ split p          ⍝ All tiles / all rotations.⍞000D    display tmat⍞000D┌→────────────────────────────┐⍞000D↓ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓ FF│ ↓ F │   ↓ F │ ↓F  │   │⍞000D│ │FF │ │FFF│   │ FF│ │FFF│   │⍞000D│ │ F │ │  F│   │FF │ │ F │   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D│ ┌→┐   ┌→────┐ ┌→┐   ┌→────┐ │⍞000D│ ↓I│   ↓IIIII│ ↓I│   ↓IIIII│ │⍞000D│ │I│   └─────┘ │I│   └─────┘ │⍞000D│ │I│           │I│           │⍞000D│ │I│           │I│           │⍞000D│ │I│           │I│           │⍞000D│ └─┘           └─┘           │⍞000D│ ┌→─┐  ┌→───┐  ┌→─┐  ┌→───┐  │⍞000D│ ↓L │  ↓LLLL│  ↓LL│  ↓   L│  │⍞000D│ │L │  │L   │  │ L│  │LLLL│  │⍞000D│ │L │  └────┘  │ L│  └────┘  │⍞000D│ │LL│          │ L│          │⍞000D│ └──┘          └──┘          │⍞000D│ ┌→─┐  ┌→───┐  ┌→─┐  ┌→───┐  │⍞000D│ ↓ N│  ↓NN  │  ↓ N│  ↓NNN │  │⍞000D│ │ N│  │ NNN│  │NN│  │  NN│  │⍞000D│ │NN│  └────┘  │N │  └────┘  │⍞000D│ │N │          │N │          │⍞000D│ └──┘          └──┘          │⍞000D│ ┌→─┐  ┌→──┐   ┌→─┐  ┌→──┐   │⍞000D│ ↓PP│  ↓PPP│   ↓ P│  ↓PP │   │⍞000D│ │PP│  │ PP│   │PP│  │PPP│   │⍞000D│ │P │  └───┘   │PP│  └───┘   │⍞000D│ └──┘          └──┘          │⍞000D│ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓TTT│ ↓  T│   ↓ T │ ↓T  │   │⍞000D│ │ T │ │TTT│   │ T │ │TTT│   │⍞000D│ │ T │ │  T│   │TTT│ │T  │   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D│ ┌→──┐ ┌→─┐    ┌→──┐ ┌→─┐    │⍞000D│ ↓U U│ ↓UU│    ↓UUU│ ↓UU│    │⍞000D│ │UUU│ │U │    │U U│ │ U│    │⍞000D│ └───┘ │UU│    └───┘ │UU│    │⍞000D│       └──┘          └──┘    │⍞000D│ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓V  │ ↓VVV│   ↓VVV│ ↓  V│   │⍞000D│ │V  │ │V  │   │  V│ │  V│   │⍞000D│ │VVV│ │V  │   │  V│ │VVV│   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D│ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓W  │ ↓ WW│   ↓WW │ ↓  W│   │⍞000D│ │WW │ │WW │   │ WW│ │ WW│   │⍞000D│ │ WW│ │W  │   │  W│ │WW │   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D│ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓ X │ ↓ X │   ↓ X │ ↓ X │   │⍞000D│ │XXX│ │XXX│   │XXX│ │XXX│   │⍞000D│ │ X │ │ X │   │ X │ │ X │   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D│ ┌→─┐  ┌→───┐  ┌→─┐  ┌→───┐  │⍞000D│ ↓ Y│  ↓  Y │  ↓Y │  ↓YYYY│  │⍞000D│ │YY│  │YYYY│  │Y │  │ Y  │  │⍞000D│ │ Y│  └────┘  │YY│  └────┘  │⍞000D│ │ Y│          │Y │          │⍞000D│ └──┘          └──┘          │⍞000D│ ┌→──┐ ┌→──┐   ┌→──┐ ┌→──┐   │⍞000D│ ↓ZZ │ ↓  Z│   ↓ZZ │ ↓  Z│   │⍞000D│ │ Z │ │ZZZ│   │ Z │ │ZZZ│   │⍞000D│ │ ZZ│ │Z  │   │ ZZ│ │Z  │   │⍞000D│ └───┘ └───┘   └───┘ └───┘   │⍞000D└∊────────────────────────────┘⍞000D⍞000D    ⎕io ← 0                         ⍝ Offset calculations easier with origin 0.⍞000D⍞000D    arena ← 4 15 ⍴ 1                ⍝ Board on which to place tiles.⍞000D    arena⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 1 1⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 1 1⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 1 1⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 1 1⍞000D⍞000D    F0 ← '' ''≠ ⊃tmat                 ⍝ 0-rotated first tile.⍞000D    F0⍞000D0 1 1⍞000D1 1 0⍞000D0 1 0⍞000D⍞000D    put←{                           ⍝ Possible placements of tile ⍺ in arena ⍵.⍞000D        ax ← (,⍵)/ ,⍳⍴ ⍵            ⍝ coordinates of arena cells.⍞000D        tx ← (,⍺)/ ,⍳⍴ ⍺            ⍝   ..      ..   tile   ..⍞000D        {∧/(tx+⊂⍵)∊ax}¨ ⍳⍴ ⍵        ⍝ displacements within the arena.⍞000D    }⍞000D⍞000D    F0 put arena                    ⍝ Possible placements of F0.⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 0 0⍞000D1 1 1 1 1 1 1 1 1 1 1 1 1 0 0⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D⍞000D    bmat ← tmat ≠ '' ''                   ⍝ Boolean matrices for all tiles.⍞000D⍞000D    disp (split p), bmat put¨ ⊂arena    ⍝ Possible placements: tiles/rotations.⍞000D┌───┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┬─────────────────────────────┐⍞000D│ FF│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│FF │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ F │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│I  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│⍞000D│I  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│⍞000D│I  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│⍞000D│I  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 0 0 0 0│⍞000D│I  │                             │                             │                             │                             │⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│L  │1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│L  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│L  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│LL │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│ N │1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│ N │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│NN │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│N  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│PP │1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│PP │1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│P  │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│TTT│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ T │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ T │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│U U│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│⍞000D│UUU│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│⍞000D│   │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│V  │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│V  │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│VVV│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│W  │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│WW │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ WW│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│ X │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│XXX│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ X │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│ Y │1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 1 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│YY │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│ Y │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│1 1 1 1 1 1 1 1 1 1 1 1 0 0 0│⍞000D│ Y │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D├───┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┼─────────────────────────────┤⍞000D│ZZ │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ Z │1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│1 1 1 1 1 1 1 1 1 1 1 1 1 0 0│⍞000D│ ZZ│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D│   │0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│0 0 0 0 0 0 0 0 0 0 0 0 0 0 0│⍞000D└───┴─────────────────────────────┴─────────────────────────────┴─────────────────────────────┴─────────────────────────────┘⍞000D⍞000D⍝ Extending the function to return not just a matrix of possible placements⍞000D⍝ but a rank-3 array, where the additional axis marks which arena cells each⍞000D⍝ placement would cover:⍞000D⍞000D    put←{                   ⍝ Arena ⍵ cells covered by placements of tile ⍺.⍞000D        ax ← (,⍵)/ ,⍳⍴ ⍵    ⍝ coordinates of arena cells.⍞000D        tx ← (,⍺)/ ,⍳⍴ ⍺    ⍝   ..      ..   tile   ..⍞000D        ↑{                  ⍝ rank-3 array of:⍞000D            p ← tx+⊂⍵       ⍝ offset of placed tile.⍞000D            a ← ax∊p        ⍝ arena cells covered.⍞000D            t ← p∊ax        ⍝ tile cells within arena.⍞000D            a ∧ ∧/t         ⍝ arena cells covered by this displacement.⍞000D        }¨⍳⍴⍵               ⍝ for each possible placement.⍞000D    }⍞000D⍞000D    ⍴ F0 put arena          ⍝ F0 (row col) placements × arena cells covered.⍞000D4 15 60⍞000D⍞000D    all ← ↑ bmat put¨ ⊂arena    ⍝ All possible placements for all tiles.⍞000D⍞000D    ⍴ all                   ⍝ Tiles × rotation × posn(row × col) × covers.⍞000D12 4 4 15 60⍞000D⍞000D    xmat ← ,[⍳4] all        ⍝ Actions vs consequences for exact cover matrix.⍞000D    ⍴ xmat⍞000D2880 60⍞000D⍞000D    pvec ← X xmat           ⍝ First attempt at placements.⍞000D    +/ pvec                 ⍝ 12 tiles placed :-)⍞000D12⍞000D⍞000D    tmp ← pvec /⍳⍴ pvec     ⍝ Row indices of placed tiles.⍞000D    tmp⍞000D180 301 306 318 333 338 348 353 668 1470 1812 2667⍞000D⍞000D    tmp ← ⍉12 4 8 8 ⊤ tmp   ⍝ Placed: tile, rotation, row, column.⍞000D    tmp⍞000D 0 2 6 4⍞000D 1 0 5 5⍞000D 1 0 6 2⍞000D 1 0 7 6⍞000D 1 1 1 5⍞000D 1 1 2 2⍞000D 1 1 3 4⍞000D 1 1 4 1⍞000D 2 2 3 4⍞000D 5 2 7 6⍞000D 7 0 2 4⍞000D10 1 5 3⍞000D⍞000D    display tmat[↓tmp[;⍳2]]             ⍝ Duplicate tiles: no cigar :-(⍞000D┌→──────────────────────────────────────────────────────────────────────────┐⍞000D│ ┌→──┐ ┌→┐ ┌→┐ ┌→┐ ┌→────┐ ┌→────┐ ┌→────┐ ┌→────┐ ┌→─┐ ┌→──┐ ┌→──┐ ┌→───┐ │⍞000D│ ↓ F │ ↓I│ ↓I│ ↓I│ ↓IIIII│ ↓IIIII│ ↓IIIII│ ↓IIIII│ ↓LL│ ↓ T │ ↓V  │ ↓  Y │ │⍞000D│ │ FF│ │I│ │I│ │I│ └─────┘ └─────┘ └─────┘ └─────┘ │ L│ │ T │ │V  │ │YYYY│ │⍞000D│ │FF │ │I│ │I│ │I│                                 │ L│ │TTT│ │VVV│ └────┘ │⍞000D│ └───┘ │I│ │I│ │I│                                 │ L│ └───┘ └───┘        │⍞000D│       │I│ │I│ │I│                                 └──┘                    │⍞000D│       └─┘ └─┘ └─┘                                                         │⍞000D└∊──────────────────────────────────────────────────────────────────────────┘⍞000D⍞000D⍝ Here''s a function to display the placements:⍞000D⍞000D    show←{⎕io ⎕ml←0                     ⍝ Simple display of tiling.⍞000D        ⍵≡0:⍵                           ⍝ failure: no tiling possible.⍞000D        (tmat arena)←⍺                  ⍝ tiles, arena and X-selection.⍞000D        (t o)(r c) ← ⍴¨ ⍺               ⍝ shapes.⍞000D        ixmat ← ⍉ (t o r c)⊤ ⍵/⍳⍴⍵      ⍝ indices: tile rotation, row col.⍞000D        tx ax ← ↓¨ 1 0 1 0⊂ixmat        ⍝ tiling and arena indices.⍞000D        tiles ← tmat[tx]                ⍝ tiles to be placed.⍞000D        tcos ← {(,⍵)/,⍳⍴⍵}¨ tiles≠'' ''   ⍝ tile coordinate vectors.⍞000D        maps ← (⍳r c)∘∊¨ tcos + ⊂¨ax    ⍝ boolean placement per tile.⍞000D        chars ← '' '', (1↑¨tcos) ⊃¨ tiles ⍝ initial letters of tiles.⍞000D        chars[↑(1+⍳t)+.× maps]          ⍝ tiling picture using initial letters.⍞000D    }⍞000D⍞000D    (tmat arena)show pvec               ⍝ Placements for pvec (note duplicates).⍞000DFIIIIIIIIIILVVV⍞000DFFFIIIIILLLLZZV⍞000DUFUIIIIIIIIIIZV⍞000DUUUIIIIIIIIIIZZ⍞000D⍞000D⍝ We need additional constraint columns to avoid X''s reusing tiles.⍞000D⍞000D    nt   ← ⊃⍴ tmat                      ⍝ Number of tiles.⍞000D    dups ← (⊃⍴ xmat) ÷ nt               ⍝ Number of rows per tile.⍞000D    unq  ← (dups/⍳ nt)∘.= ⍳ nt          ⍝ Unique tiles constraint columns.⍞000D⍞000D:If 1∊''v*''∊Alpha                        ⍝ Verbose or *: takes around 0.1 seconds.⍞000D⍞000D        (tmat arena)show X xmat, unq    ⍝ Successful tiling; hurrah!⍞000D    FIIIIILLLLXYYYY⍞000D    FFFNNNLTWXXXYZV⍞000D    UFUPPNNTWWXZZZV⍞000D    UUUPPPTTTWWZVVV⍞000D⍞000D:EndIf⍞000D⍞000D⍞000D⍝ Collecting all of the above into a couple of functions:⍞000D⍞000D    pcomp←{⎕ml←0                        ⍝ Pentomino compilation.⍞000D⍞000D        ⍺← ↑⌽{                          ⍝ default tiles:⍞000D            ⍵,⊂''     I                                    ''}{⍞000D            ⍵,⊂''     I L   N                         Y    ''}{⍞000D            ⍵,⊂''  FF I L   N PP TTT     V   W    X  YY ZZ ''}{⍞000D            ⍵,⊂'' FF  I L  NN PP  T  U U V   WW  XXX  Y  Z ''}{⍞000D            ⍵,⊂''  F  I LL N  P   T  UUU VVV  WW  X   Y  ZZ''}⍬⍞000D⍞000D        split←{                         ⍝ Individual tiles.⍞000D            segs ← 0 1∘↓¨ (∧⌿⍵='' '')⊂⍵   ⍝ separated at blank columns.⍞000D            {(∨/⍵≠'' '')⌿⍵}¨ segs         ⍝ without blank rows.⍞000D        }⍞000D⍞000D        rots ← {⍵(⍉⊖⍵)(⌽⊖⍵)(⊖⍉⍵)}       ⍝ tile rotations.⍞000D⍞000D        flips ← {⍵,⍉¨⍵}⍣⍵               ⍝ ⍵: include turn-overs.⍞000D⍞000D        ↑ flips¨ rots¨ split ⍺          ⍝ All tiles / all rotations.⍞000D    }⍞000D⍞000D    tile←{⎕io ⎕ml←0                 ⍝ ⍺-tiling of arena ⍵.⍞000D⍞000D        ⍺ ← pcomp 0                 ⍝ standard pentomino set; rotations only.⍞000D⍞000D        put←{                       ⍝ ⍵-cells covered by all posns of tile ⍺.⍞000D            ax ← (,⍵)/ ,⍳⍴ ⍵        ⍝ coordinates of arena cells.⍞000D            tx ← (,⍺)/ ,⍳⍴ ⍺        ⍝   ..      ..   tile   ..⍞000D            ↑{                      ⍝ rank-3 array of:⍞000D                p ← tx+⊂⍵           ⍝ offset of placed tile.⍞000D                a ← ax∊p            ⍝ arena cells covered.⍞000D                t ← p∊ax            ⍝ tile cells within arena.⍞000D                a∧∧/t               ⍝ arena cells covered by this displacement.⍞000D            }¨⍳⍴⍵                   ⍝ for each possible placement.⍞000D        }⍞000D⍞000D        all  ← ↑ (⍺≠'' '') put¨ ⊂⍵    ⍝ all possible placements for all tiles.⍞000D        xmat ← ,[⍳4] all            ⍝ actions vs consequences matrix.⍞000D        nt   ← ⊃⍴ ⍺                 ⍝ number of tiles.⍞000D        dups ← (⊃⍴ xmat) ÷ nt       ⍝ number of rows per tile.⍞000D        unq  ← (dups/⍳ nt)∘.= ⍳ nt  ⍝ unique tiles constraint columns.⍞000D⍞000D        (⍺ ⍵) show X xmat,unq       ⍝ tile placements.⍞000D    }⍞000D⍞000D⍝ This function, uses box-drawing characters as grouting between the tiles:⍞000D⍞000D    pretty←{                            ⍝ Outlined placements.⍞000D        ⍵≡0:''No tiling possible''        ⍝ failure: :-(⍞000D        ⍺←1 2 ⋄ h v←⍺                   ⍝ aspect ratio.⍞000D        n←h⌿v/⍵                         ⍝ aspect-stretched tiles.⍞000D        m←''$''⍪(''$'',n,''$'')⍪''$''           ⍝ $-framed tiling.⍞000D        r c←(1+2×⍴m)⍴¨⊂0 1              ⍝ row and column expansion vectors.⍞000D        x←r{⍵⍵\⍺⍺⍀⍵}c                   ⍝ matrix expansion.⍞000D        s←{⍺⊃¨↑,¨/⊂¨¨⍵}                 ⍝ select.⍞000D        a←x(m='' '')s m''$''                ⍝ expanded grid.⍞000D        b←(1⊖x 0⍪2≠⌿m)s a''*''            ⍝ vertical tile separators.⍞000D        c←(1⌽x 0,2≠/m)s b''*''            ⍝ horizontal  ..      ..⍞000D        adj←{↑(1 ¯1⌽¨⊂⍵)∨.∨1 ¯1⊖¨⊂⍵}    ⍝ bleed of adjacent *s.⍞000D        msk←(c='' '')∧adj c=''*''           ⍝ *s flooded into blanks.⍞000D        f←draw msk s c''*''               ⍝ $-framed picture →draw←⍞000D        g←(f=''$'')s f '' ''                ⍝ restoring blanks.⍞000D        2 0↓¯2 0↓0 2↓0 ¯2↓g             ⍝ unframed picture.⍞000D    }⍞000D⍞000D:If 1∊''v*''∊Alpha                        ⍝ Verbose or *: takes around 3 seconds:⍞000D⍞000D        pretty tile 4 15⍴1              ⍝ 4×15 board, as above.⍞000D    ┌───┬───────────────────┬───────────────┬───┬───────────────┐⍞000D    │F F│I I I I I I I I I I│L L L L L L L L│X X│Y Y Y Y Y Y Y Y│⍞000D    │   └───────┬───────────┤   ┌───┬───┬───┘   └───┐   ┌───┬───┤⍞000D    │F F F F F F│N N N N N N│L L│T T│W W│X X X X X X│Y Y│Z Z│V V│⍞000D    ├───┐   ┌───┼───────┐   └───┤   │   └───┐   ┌───┴───┘   │   │⍞000D    │U U│F F│U U│P P P P│N N N N│T T│W W W W│X X│Z Z Z Z Z Z│V V│⍞000D    │   └───┘   │       └───┬───┘   └───┐   └───┤   ┌───────┘   │⍞000D    │U U U U U U│P P P P P P│T T T T T T│W W W W│Z Z│V V V V V V│⍞000D    └───────────┴───────────┴───────────┴───────┴───┴───────────┘⍞000D⍞000D⍞000D        pretty tile 5 12⍴1              ⍝ 5×12 board.⍞000D    ┌───┬───────────┬───────────┬───────────────┬───┐⍞000D    │F F│N N N N N N│T T T T T T│Y Y Y Y Y Y Y Y│P P│⍞000D    │   └───────┐   └───┐   ┌───┴───┐   ┌───┬───┘   │⍞000D    │F F F F F F│N N N N│T T│W W W W│Y Y│V V│P P P P│⍞000D    ├───┐   ┌───┼───────┤   ├───┐   └───┤   │       │⍞000D    │U U│F F│U U│Z Z Z Z│T T│X X│W W W W│V V│P P P P│⍞000D    │   └───┘   ├───┐   ├───┘   └───┐   │   └───────┤⍞000D    │U U U U U U│L L│Z Z│X X X X X X│W W│V V V V V V│⍞000D    ├───────────┘   │   └───┐   ┌───┴───┴───────────┤⍞000D    │L L L L L L L L│Z Z Z Z│X X│I I I I I I I I I I│⍞000D    └───────────────┴───────┴───┴───────────────────┘⍞000D⍞000D        pretty tile 6 10⍴1              ⍝ 6×10 board.⍞000D    ┌───┬───────────────────┬───┬───────────┐⍞000D    │F F│I I I I I I I I I I│T T│U U U U U U│⍞000D    │   └───────┬───┬───────┘   │   ┌───┐   │⍞000D    │F F F F F F│W W│T T T T T T│U U│X X│U U│⍞000D    ├───┐   ┌───┘   ├───────┐   ├───┘   └───┤⍞000D    │L L│F F│W W W W│N N N N│T T│X X X X X X│⍞000D    │   ├───┘   ┌───┴───┐   └───┴───┐   ┌───┤⍞000D    │L L│W W W W│Z Z Z Z│N N N N N N│X X│V V│⍞000D    │   ├───────┴───┐   ├───────────┴───┤   │⍞000D    │L L│P P P P P P│Z Z│Y Y Y Y Y Y Y Y│V V│⍞000D    │   └───┐       │   └───┐   ┌───────┘   │⍞000D    │L L L L│P P P P│Z Z Z Z│Y Y│V V V V V V│⍞000D    └───────┴───────┴───────┴───┴───────────┘⍞000D⍞000D        pretty tile ~(⍳8 8)∊3+⍳2 2      ⍝ 8×8 board with 2×2 hole in centre.⍞000D    ┌───┬───────────┬───────────┬───┐⍞000D    │I I│U U U U U U│V V V V V V│Z Z│⍞000D    │   │   ┌───┐   │   ┌───────┘   │⍞000D    │I I│U U│X X│U U│V V│Z Z Z Z Z Z│⍞000D    │   ├───┘   └───┤   │   ┌───────┤⍞000D    │I I│X X X X X X│V V│Z Z│W W W W│⍞000D    │   ├───┐   ┌───┴───┼───┘   ┌───┤⍞000D    │I I│N N│X X│       │W W W W│Y Y│⍞000D    │   │   ├───┤       │   ┌───┘   │⍞000D    │I I│N N│F F│       │W W│Y Y Y Y│⍞000D    ├───┘   │   └───┬───┴───┼───┐   │⍞000D    │N N N N│F F F F│P P P P│T T│Y Y│⍞000D    │   ┌───┘   ┌───┤       │   │   │⍞000D    │N N│F F F F│L L│P P P P│T T│Y Y│⍞000D    ├───┴───────┘   │   ┌───┘   └───┤⍞000D    │L L L L L L L L│P P│T T T T T T│⍞000D    └───────────────┴───┴───────────┘⍞000D⍞000D        pretty tile ~(⍳8 8)∊2 5∘.,3 4   ⍝ 8×8 board with 2 holes.⍞000D    ┌───┬───────────┬───────────────┐⍞000D    │F F│N N N N N N│Y Y Y Y Y Y Y Y│⍞000D    │   └───────┐   └───┐   ┌───────┤⍞000D    │F F F F F F│N N N N│Y Y│L L L L│⍞000D    ├───┐   ┌───┼───────┼───┼───┐   │⍞000D    │I I│F F│P P│       │Z Z│V V│L L│⍞000D    │   ├───┘   ├───────┘   │   │   │⍞000D    │I I│P P P P│Z Z Z Z Z Z│V V│L L│⍞000D    │   │       │   ┌───────┘   │   │⍞000D    │I I│P P P P│Z Z│V V V V V V│L L│⍞000D    │   ├───┬───┼───┴───┬───┬───┴───┤⍞000D    │I I│T T│W W│       │X X│U U U U│⍞000D    │   │   │   └───┬───┘   └───┐   │⍞000D    │I I│T T│W W W W│X X X X X X│U U│⍞000D    ├───┘   └───┐   └───┐   ┌───┘   │⍞000D    │T T T T T T│W W W W│X X│U U U U│⍞000D    └───────────┴───────┴───┴───────┘⍞000D⍞000D:EndIf' 
