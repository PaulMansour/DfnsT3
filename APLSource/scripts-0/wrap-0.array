'⍝ Wrap word vector at ⍺ cols:⍞000D⍞000D    26 wrap ⎕a⍞000DABCDEFGHIJKLMNOPQRSTUVWXYZ⍞000D⍞000D    26 wrap,''A''⍞000DA⍞000D    '' ·''subs 20 wrap 20⍴''tick ''⍞000Dtick·tick·tick·tick·⍞000D⍞000D    '' ·''subs 19 wrap 20⍴''tock ''⍞000Dtock·tock·tock·tock⍞000D                   ⍞000D    '' ·''subs 18 wrap 20⍴''tuck ''⍞000Dtuck·tuck·tuck⍞000Dtuck·         ⍞000D⍞000D      '' ·''subs 10 wrap ⎕a       ⍝ butchered long "word".⍞000DABCDEFGHIJ⍞000DKLMNOPQRST⍞000DUVWXYZ    ⍞000D⍞000D      10 wrap 10 ¯1 10\''AB''     ⍝ no extra line if exact wrap.⍞000DAAAAAAAAAA⍞000DBBBBBBBBBB⍞000D⍞000D      10 wrap 10 ¯5 5\''AB''      ⍝ no removal of wrapped blanks.⍞000DAAAAAAAAAA⍞000D    BBBBB ⍞000D⍞000D      '' ·''subs 20 wrap(1↓,⍉↑⍬(1 to 26))\⎕a⍞000DA·BB·CCC·DDDD·EEEEE ⍞000DFFFFFF·GGGGGGG      ⍞000DHHHHHHHH·IIIIIIIII  ⍞000DJJJJJJJJJJ          ⍞000DKKKKKKKKKKK         ⍞000DLLLLLLLLLLLL        ⍞000DMMMMMMMMMMMMM       ⍞000DNNNNNNNNNNNNNN      ⍞000DOOOOOOOOOOOOOOO     ⍞000DPPPPPPPPPPPPPPPP    ⍞000DQQQQQQQQQQQQQQQQQ   ⍞000DRRRRRRRRRRRRRRRRRR  ⍞000DSSSSSSSSSSSSSSSSSSS ⍞000DTTTTTTTTTTTTTTTTTTTT⍞000DUUUUUUUUUUUUUUUUUUUU⍞000DU                   ⍞000DVVVVVVVVVVVVVVVVVVVV⍞000DVV                  ⍞000DWWWWWWWWWWWWWWWWWWWW⍞000DWWW                 ⍞000DXXXXXXXXXXXXXXXXXXXX⍞000DXXXX                ⍞000DYYYYYYYYYYYYYYYYYYYY⍞000DYYYYY               ⍞000DZZZZZZZZZZZZZZZZZZZZ⍞000DZZZZZZ              ⍞000D⍞000D    Alpha test''Line_vectors''⍞000D1⍞000D⍞000D    txt←''Say can I have some of your purple berries? Yes, I''''ve been eating them for six or seven weeks now; haven''''t got sick once. Prob''''ly keep us both alive.''⍞000D⍞000D    wrap←{⎕io←1             ⍝ ⍺-wrap (Bob Smith).⍞000D        ⍺←⎕pw               ⍝ default ⎕pw-wrap⍞000D        v←'' '',⍵,'' ''         ⍝ blanks required at start and end⍞000D        j←(v='' '')/⍳⍴v       ⍝ indices of blanks⍞000D        p←(j+⍺+1)∘.<j       ⍝ 1s mark blanks past the cutoff⍞000D        m←p<1⌽p             ⍝ mark last blank that fits on the line⍞000D        i←(⍴m)⍴1,(1↓⍴m)⍴0   ⍝ identity matrix⍞000D        c←⌹i-m              ⍝ compute transitive closure of m⍞000D        v[c[1;]/j]←⊃⌽⎕tc    ⍝ insert the line breaks⍞000D        1↓¯1↓v              ⍝ drop the extra blanks⍞000D    }⍞000D⍞000D    '' ·''subs 24 wrap txt⍞000DSay·can·I·have·some·of ⍞000Dyour·purple·berries?   ⍞000DYes,·I''ve·been·eating  ⍞000Dthem·for·six·or·seven  ⍞000Dweeks·now;·haven''t·got ⍞000Dsick·once.·Prob''ly·keep⍞000Dus·both·alive.         ⍞000D⍞000D    wrap←{⎕io ⎕ml←1 0 ⋄       ⍝ ⍺-wrap (John Daintree).⍞000D        ⍺←⎕PW                 ⍝ initialize⍞000D        ⍺≥⍴,⍵:,⊂⍵             ⍝ out if short enough⍞000D        sze←(⍵∊''-?., '')/⍳⍴⍵   ⍝ length of each choice⍞000D        len←⊃⌽(⍺≥sze)/sze     ⍝ longest length⍞000D        len←⊃(len∊sze)⌽⍺ len  ⍝ middle of word?⍞000D        (⊂len↑⍵),⍺ ∇ len↓⍵    ⍝ at valid wrap point⍞000D    }⍞000D⍞000D    '' ·''subs 1 disp 24 wrap txt⍞000D┌→──────────────────────┬─────────────────────┬──────────────────────┬──────────────────────┬───────────────────────┬────────────────────────┬──────────────┐⍞000D│Say·can·I·have·some·of·│your·purple·berries?·│Yes,·I''ve·been·eating·│them·for·six·or·seven·│weeks·now;·haven''t·got·│sick·once.·Prob''ly·keep·│us·both·alive.│⍞000D└──────────────────────→┴────────────────────→┴─────────────────────→┴─────────────────────→┴──────────────────────→┴───────────────────────→┴─────────────→┘' 
