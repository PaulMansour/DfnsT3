'⍝ Quad-tree packing:⍞000D⍞000D      disp pack4 10 20 30/''abc''⍞000D┌───┬──┬──────────────────────┐⍞000D│abc│60│¯3 0 ¯2 0 ¯1 0 1 1 1 2│⍞000D└───┴──┴──────────────────────┘⍞000D⍞000D    0 pack4 pack4 10 20 30/''abc''    ⍝ round-trip⍞000Daaaaaaaaaabbbbbbbbbbbbbbbbbbbbcccccccccccccccccccccccccccccc⍞000D⍞000D    chk←{⍵≡0 pack4 pack4 ⍵}         ⍝ check round-trip⍞000D⍞000D    chk 10 20/''ab''⍞000D1⍞000D    chk¨ 99 (⊂''hello'')              ⍝ check scalar cases⍞000D1 1⍞000D    chk (4/4)↑4                     ⍝ check higher-rank array⍞000D1⍞000D    chk ⎕a                          ⍝ worst case: no similar regions.⍞000D1⍞000D    ∧/ chk¨ '''' ''a'' ''aa'' ''ab'' ''aab'' ''abb''    ⍝ edge cases.⍞000D1⍞000D    chk{⍵⍴⍳×/⍵}5/3                  ⍝ worst case: check default ⍺ is adequate.⍞000D1⍞000D    chk 2 3 0 5 6 ⍴ 88              ⍝ check empty array⍞000D1⍞000D    pack4{⍵≡0 ⍺⍺ 0 ⍺⍺¨ ⍺⍺¨ ⍺⍺ ⍵} 10 20/''ab''     ⍝ pack of pack.⍞000D1⍞000D    quads←{⌊/¨⌊((⍳⍺/⍵×⍵)-⎕io)÷⍵}    ⍝ "quadrants" image⍞000D⍞000D    1 quads 4                       ⍝ 1-quad⍞000D0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3⍞000D⍞000D    2 quads 4                       ⍝ 2-quad⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0⍞000D0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1⍞000D0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1⍞000D0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1⍞000D0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1⍞000D0 0 0 0 1 1 1 1 2 2 2 2 2 2 2 2⍞000D0 0 0 0 1 1 1 1 2 2 2 2 2 2 2 2⍞000D0 0 0 0 1 1 1 1 2 2 2 2 2 2 2 2⍞000D0 0 0 0 1 1 1 1 2 2 2 2 2 2 2 2⍞000D0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3⍞000D0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3⍞000D0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3⍞000D0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3⍞000D⍞000D    disp pack4 2 quads 4            ⍝ pack of 2-quad⍞000D┌───────┬─────┬────────────────────────────────────────────┐⍞000D│0 1 2 3│16 16│¯3 0 ¯1 0 1 ¯1 0 1 ¯3 0 1 ¯1 0 1 ¯1 2 ¯1 2 3│⍞000D└───────┴─────┴────────────────────────────────────────────┘⍞000D⍞000D    cmp←{(⍴,⍵)(⍴¨pack4 ⍵)}          ⍝ compare ravel-shape with pack shapes for:⍞000D⍞000D    disp cmp 2 quads 4              ⍝ 2-quad⍞000D┌───┬────────┐⍞000D│256│┌─┬─┬──┐│⍞000D│   ││4│2│19││⍞000D│   │└─┴─┴──┘│⍞000D└───┴────────┘⍞000D⍞000D    disp {(⍴,⍵)(⍴¨pack4 ⍵)}3 quads 4    ⍝ 3-quad⍞000D┌────┬────────┐⍞000D│4096│┌─┬─┬──┐│⍞000D│    ││4│3│58││⍞000D│    │└─┴─┴──┘│⍞000D└────┴────────┘⍞000D⍞000D    disp {(⍴,⍵)(⍴¨pack4 ⍵)}4 quads 4    ⍝ 4-quad⍞000D┌─────┬─────────┐⍞000D│65536│┌─┬─┬───┐│⍞000D│     ││4│4│179││⍞000D│     │└─┴─┴───┘│⍞000D└─────┴─────────┘⍞000D⍞000D    image←⌈0.5×∘.⌊⍨⍳8⍞000D⍞000D    image⍞000D1 1 1 1 1 1 1 1⍞000D1 1 1 1 1 1 1 1⍞000D1 1 2 2 2 2 2 2⍞000D1 1 2 2 2 2 2 2⍞000D1 1 2 2 3 3 3 3⍞000D1 1 2 2 3 3 3 3⍞000D1 1 2 2 3 3 4 4⍞000D1 1 2 2 3 3 4 4⍞000D⍞000D    ,[⍬]disp¨{⍵ pack4 image}¨1 to 5         ⍝ decreasing resolution.⍞000D ┌───────┬───┬────────────────────────────────────────────┐ ⍞000D │1 2 3 4│8 8│¯3 0 ¯1 0 1 ¯1 0 1 ¯3 0 1 ¯1 0 1 ¯1 2 ¯1 2 3│ ⍞000D └───────┴───┴────────────────────────────────────────────┘ ⍞000D ┌───────┬───┬───────────┐                                  ⍞000D │1 2 3 4│8 8│¯1 0 ¯1 0 2│                                  ⍞000D └───────┴───┴───────────┘                                  ⍞000D ┌───────┬───┬───────────┐                                  ⍞000D │1 2 3 4│8 8│¯1 0 ¯1 0 2│                                  ⍞000D └───────┴───┴───────────┘                                  ⍞000D ┌───────┬───┬─┐                                            ⍞000D │1 2 3 4│8 8│0│                                            ⍞000D └───────┴───┴─┘                                            ⍞000D ┌───────┬───┬─┐                                            ⍞000D │1 2 3 4│8 8│0│                                            ⍞000D └───────┴───┴─┘                                            ⍞000D⍞000D    disp{0 pack4 ⍵ pack4 image}¨1 to 5      ⍝ decreasing resolution.     ⍞000D┌───────────────┬───────────────┬───────────────┬───────────────┬───────────────┐⍞000D│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 2 2 2 2│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 2 2 2 2│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 3 3 4 4│1 1 1 1 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D│1 1 2 2 3 3 4 4│1 1 1 1 3 3 3 3│1 1 1 1 3 3 3 3│1 1 1 1 1 1 1 1│1 1 1 1 1 1 1 1│⍞000D└───────────────┴───────────────┴───────────────┴───────────────┴───────────────┘' 
