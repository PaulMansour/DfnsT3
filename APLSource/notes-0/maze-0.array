'cmat← {smooth←1} ##.maze shape              ⍝ Kidz maze.⍞000D⍞000DReturns  a random maze of specified shape. Note that the rank of the maze may be⍞000Dgreater  than  2.  The optional left argument determines whether the output will⍞000Duse "smooth" box-drawing characters (default) or "clunky" characters,  which are⍞000Dpresent in all fonts.⍞000D⍞000DEntry to, and exit from the maze is through a portal, top left and bottom right,⍞000Dmarked "↓".⍞000D⍞000DIn  a  high-rank maze, we can move within a plane in the normal way, or warp be-⍞000Dtween  planes, up-down/left-right (but not diagonally), providing our way is not⍞000Dblocked by a closed cell containing a ∘. See examples below.⍞000D⍞000DTechnical notes:⍞000D⍞000DMaze construction is in two stages:⍞000D⍞000D[path]  Starting at the entrance and exit, a pair of random paths  are  extended⍞000D        alternately into the maze, until they meet. This is the solution path.⍞000D⍞000D[fill]  Starting  from each randomly chosen unvisited cell, a random path is ex-⍞000D        tended until it collides with an existing path. This is a "tributary" of⍞000D        the solution path.⍞000D⍞000DAs  an  exercise  in  functional programming, the coding of the maze function is⍞000D"stateless".  This  means  that  there  are no variables (only definitions, that⍞000Ddon''t  vary)  and no partial assignments, such as ]← and )←. In particular, sub-⍞000Dfunction →select← has been used in places where indexed assignment would be con-⍞000Dsiderably  faster  on  the  grounds that, for a folly such as this, the speed of⍞000Dexecution may take second place to exploration of programming techniques.⍞000D⍞000DAs a coding aid, the closing } of some of the inner functions have been labelled⍞000Dusing an ad hoc notation, with  the "type" of the function. For example initial-⍞000Disation  function [init] is labelled: (c d)(fm to)←:: size. This is to be inter-⍞000Dpreted as "function takes a right argument of size and returns a nested 2-vector⍞000Dof  control and display arrays, and from and to node indices". Similarly, funct-⍞000Dion  [extend]  is of type: (c d)(fm to)←(c d)tag :: path, which means it takes a⍞000Dpath  vector  on  the right and a "structure" on the left, and returns a pair of⍞000Dpairs.⍞000D⍞000DExamples:⍞000D⍞000D      maze 10 20        ⍝ 2-maze.⍞000D┌↓────┬───────┬───┬─────────────┬───┬───┐⍞000D│     │       │   │             │   │   │⍞000D│ ┌─┬─┴─┬─┐ │ └─┐ └── │ ────┬── │ │ └── │⍞000D│ │ │   │ │ │   │     │     │     │     │⍞000D│ │ │ │ │ │ └───┘ ──┬─┼── ──┼───┬─┼──── │⍞000D│ │   │   │         │ │     │   │ │     │⍞000D│ └── │ ──┘ ┌───┐ ──┘ │ ──┐ ├─┐ │ └─┬── │⍞000D│     │     │   │     │   │ │ │     │   │⍞000D│ ──┐ ├─┬───┤ │ │ ──┐ ├─┬─┤ │ ├──── └─┐ │⍞000D│   │ │ │   │ │     │ │ │ │   │       │ │⍞000D├── │ │ │ │ │ │ │ │ └─┘ │ └── │ ┌─────┤ │⍞000D│   │   │ │   │ │ │     │     │ │     │ │⍞000D├─┐ ├───┘ ├─┬─┴─┼─┴─────┼───┬─┘ │ ┌── │ │⍞000D│ │ │     │ │   │       │   │     │   │ │⍞000D│ │ ├── ──┤ │ │ │ ──┬───┘ │ │ ┌───┤ ──┤ │⍞000D│   │     │   │ │   │     │ │ │   │   │ │⍞000D│ ──┼─┐ │ └─┬─┘ └── │ │ │ │ │ │ │ └─┐ │ │⍞000D│   │ │ │   │       │ │ │ │ │   │   │   │⍞000D│ ──┘ │ │ │ │ ──┬── └─┴─┴─┘ ├── └─┐ └───┤⍞000D│     │ │ │     │           │     │     │⍞000D└─────┴─┴─┴─────┴───────────┴─────┴────↓┘⍞000D⍞000D      0 maze 10 20      ⍝ same maze with clunky output.⍞000D+↓+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+⍞000D|     |       |   |             |   |   |⍞000D+ +-+-+-+-+ + +-+ +-+ + +-+-+-+ + + +-+ +⍞000D| | |   | | |   |     |     |     |     |⍞000D+ + + + + + +-+-+ +-+-+-+ +-+-+-+-+-+-+ +⍞000D| |   |   |         | |     |   | |     |⍞000D+ +-+ + +-+ +-+-+ +-+ + +-+ +-+ + +-+-+ +⍞000D|     |     |   |     |   | | |     |   |⍞000D+ +-+ +-+-+-+ + + +-+ +-+-+ + +-+-+ +-+ +⍞000D|   | | |   | |     | | | |   |       | |⍞000D+-+ + + + + + + + + +-+ + +-+ + +-+-+-+ +⍞000D|   |   | |   | | |     |     | |     | |⍞000D+-+ +-+-+ +-+-+-+-+-+-+-+-+-+-+ + +-+ + +⍞000D| | |     | |   |       |   |     |   | |⍞000D+ + +-+ +-+ + + + +-+-+-+ + + +-+-+ +-+ +⍞000D|   |     |   | |   |     | | |   |   | |⍞000D+ +-+-+ + +-+-+ +-+ + + + + + + + +-+ + +⍞000D|   | | |   |       | | | | |   |   |   |⍞000D+ +-+ + + + + +-+-+ +-+-+-+ +-+ +-+ +-+-+⍞000D|     | | |     |           |     |     |⍞000D+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+↓+⍞000D⍞000D      maze 3 3 4        ⍝ 3-maze⍞000D ┌─┬─┬─┬─┐  ┌─┬─┬───┐  ┌─┬─┬─┬─┐  ┌───┬─┬─┐  ┌─┬─┬─┬─┐  ┌───────┐  ┌─┬─┬─┬─┐⍞000D │↓│∘│∘│∘│  │ │ │   │  │ │∘│ │∘│  │   │ │ │  │∘│∘│∘│ │  │       │  │∘│∘│∘│∘│⍞000D ├─┼─┼─┼─┤  ├─┘ ├── │  ├─┼─┼─┼─┤  │ │ ├─┴─┤  ├─┼─┼─┼─┤  ├──── │ │  ├─┼─┼─┼─┤⍞000D │∘│∘│∘│∘│  │   │   │  │∘│ │∘│ │  │ │ │   │  │ │∘│ │∘│  │     │ │  │∘│∘│∘│∘│⍞000D ├─┼─┼─┼─┤  ├───┼── │  ├─┼─┼─┼─┤  │ ├─┴───┤  ├─┼─┼─┼─┤  ├───┐ └─┤  ├─┼─┼─┼─┤⍞000D │∘│∘│∘│∘│  │   │   │  │ │ │∘│∘│  │ │     │  │∘│ │∘│∘│  │   │   │  │∘│∘│∘│↓│⍞000D └─┴─┴─┴─┘  └───┴───┘  └─┴─┴─┴─┘  └─┴─────┘  └─┴─┴─┴─┘  └───┴───┘  └─┴─┴─┴─┘⍞000D⍞000DThe route through this maze is as follows:⍞000D⍞000D  ↓ entrance⍞000D ┌─┬─┬─┬─┐  ┌─┬─┬───┐  ┌─┬─┬─┬─┐  ┌───┬─┬─┐  ┌─┬─┬─┬─┐  ┌───────┐  ┌─┬─┬─┬─┐⍞000D │1│∘│∘│∘│  │2│ │   │  │3│∘│ │∘│  │4  │ │ │  │∘│∘│∘│ │  │       │  │∘│∘│∘│∘│⍞000D ├─┼─┼─┼─┤  ├─┘ ├── │  ├─┼─┼─┼─┤  │ │ ├─┴─┤  ├─┼─┼─┼─┤  ├──── │ │  ├─┼─┼─┼─┤⍞000D │∘│∘│∘│∘│  │   │   │  │∘│ │∘│ │  │5│ │   │  │6│∘│ │∘│  │7    │ │  │∘│∘│∘│∘│⍞000D ├─┼─┼─┼─┤  ├───┼── │  ├─┼─┼─┼─┤  │ ├─┴───┤  ├─┼─┼─┼─┤  ├───┐ └─┤  ├─┼─┼─┼─┤⍞000D │∘│∘│∘│∘│  │   │   │  │ │ │∘│∘│  │ │     │  │∘│ │∘│∘│  │   │  8│  │∘│∘│∘│9│⍞000D └─┴─┴─┴─┘  └───┴───┘  └─┴─┴─┴─┘  └─┴─────┘  └─┴─┴─┴─┘  └───┴───┘  └─┴─┴─┴─┘⍞000D                                                                     exit ↓⍞000DSimilarly:⍞000D⍞000D      maze 2 3 2 3      ⍝ 4-maze.⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │↓│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │ │ │ │  │ │ │ │  │ │   │  │∘│∘│ │  │ │   │  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┴─┴─┤  ├─┼─┼─┤  ├─┼─┬─┤  ├─┼─┼─┤  ├─┴───┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │     │  │∘│∘│ │  │ │ │ │  │ │∘│∘│  │     │  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─────┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─────┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │ │ │∘│  │∘│∘│∘│  │∘│ │∘│  │∘│∘│∘│  │ │ │∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │ │∘│∘│  │∘│∘│∘│  │ │ │ │  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─────┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │ │   │  │ │∘│∘│  │ │   │  │∘│∘│∘│  │     │  │∘│∘│∘│⍞000D  ├─┼─┼─┤  │ ├─┬─┤  ├─┼─┼─┤  ├─┘ │ │  ├─┼─┼─┤  │ │ ──┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │ │ │ │  │∘│ │ │  │   │ │  │∘│∘│∘│  │ │   │  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └───┴─┘  └─┴─┴─┘  └─┴───┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│↓│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D⍞000DWith solution:⍞000D⍞000D            ↓ entrance⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │a│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │b│ │ │  │ │ │ │  │ │o p│  │∘│∘│q│  │ │s r│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┴─┴─┤  ├─┼─┼─┤  ├─┼─┬─┤  ├─┼─┼─┤  ├─┴───┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │g   h│  │∘│∘│i│  │ │ │j│  │ │∘│∘│  │     │  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─────┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─────┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │c│ │∘│  │∘│∘│∘│  │∘│n│∘│  │∘│∘│∘│  │ │t│∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │f│∘│∘│  │∘│∘│∘│  │ │ │k│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─┬───┐  ┌─┬─┬─┐  ┌─────┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │d│   │  │ │∘│∘│  │ │m  │  │∘│∘│∘│  │  u  │  │∘│∘│∘│⍞000D  ├─┼─┼─┤  │ ├─┬─┤  ├─┼─┼─┤  ├─┘ │ │  ├─┼─┼─┤  │ │ ──┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │e│ │ │  │∘│ │ │  │   │l│  │∘│∘│∘│  │ │  v│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └───┴─┘  └─┴─┴─┘  └─┴───┘  └─┴─┴─┘⍞000D⍞000D  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐  ┌─┬─┬─┐⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│⍞000D  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤  ├─┼─┼─┤⍞000D  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│∘│  │∘│∘│w│  │∘│∘│∘│⍞000D  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘  └─┴─┴─┘⍞000D                                               exit ↓⍞000D⍞000DSee also: select hampton⍞000D⍞000DIndex:diversions|assignment, indexed|maze|box-drawing characters' 
