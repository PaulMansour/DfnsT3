'soln ← ##.quzzle grid                       ⍝ A hard, simple problem.⍞000D⍞000DSupplied  by  David  Crossley, who says: I spotted this puzzle in the Economist,⍞000DDec 4-10,2004, "A hard, simple problem", p82.⍞000D⍞000DA  grid  of squares of unit size is represented by a text matrix. The grid cont-⍞000Dains an initial setup of non-overlapping, rectangular tiles whose sides are 1 or⍞000Dmore  units.  Each tile is identified by a unique character (except ''∣'' or ''_'').⍞000DThus,  the tile marked 1 below is a 2×2 tile; 3 is a 2×1 tile. Blank squares can⍞000Dbe moved into.⍞000D⍞000DHere is an example setup in a 5×4 grid:       1122       top left tile is 11⍞000D                                              1134                        11⍞000DThe task is to move the 2×2 tile (1) in         34⍞000Dthe top-left corner to any other corner       5667       top right tile is 22⍞000Dby sliding tiles up, down, left or right.     5889⍞000D⍞000DThere are just 2 initial moves:  1-down or 5-up. It´s not as simple as it looks!⍞000D⍞000DFunction  [quzzle] works out the shortest possible solutions for puzzles of this⍞000Dclass, though it may take some time for larger grids.⍞000D⍞000DExample:⍞000D⍞000D    ⎕←grid←5 4⍴''11221134  3456675889''⍞000D1122⍞000D1134⍞000D  34⍞000D5667⍞000D5889⍞000D⍞000D    quzzle grid⍞000D Bottom-right  Bottom-left⍞000D in 37 moves   in 56 moves⍞000D⍞000D 1↓            1↓⍞000D 2←            2←⍞000D 2←            2←⍞000D 3↑            3↑⍞000D 4↑            4↑⍞000D 7↑            7↑⍞000D 7←            7←⍞000D 4↓            4↓⍞000D 4↓            4↓⍞000D 3→            3→⍞000D 7↑            7↑⍞000D 7↑            7↑⍞000D 1→            1→⍞000D 5↑            5↑⍞000D 5↑            5↑⍞000D 6←            6←⍞000D 8←            8←⍞000D 9←            9←⍞000D 9↑            9↑⍞000D 8→            8→⍞000D 8→            8→⍞000D 6↓            6↓⍞000D 9←            9←⍞000D 9←            9←⍞000D 1↓            1↓⍞000D 7↓            7↓⍞000D 7←            7←⍞000D 3←            3←⍞000D 4↑            4↑⍞000D 4↑            4↑⍞000D 1→            1→⍞000D 9→            9→⍞000D 9↑            5↓⍞000D 6↑            7←⍞000D 8←            9↑⍞000D 8←            9↑⍞000D 1↓            1←⍞000D               4↓⍞000D               4↓⍞000D               3→⍞000D               2→⍞000D               9→⍞000D               7→⍞000D               5↑⍞000D               5↑⍞000D               1←⍞000D               4←⍞000D               3↓⍞000D               2→⍞000D               7↑⍞000D               9←⍞000D               4↑⍞000D               8↑⍞000D               6→⍞000D               6→⍞000D               1↓⍞000D⍞000DIndex:diversions|puzzle⍞000DIndex;Crossley A.D.' 
